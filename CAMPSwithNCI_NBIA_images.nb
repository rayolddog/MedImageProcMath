(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106272,       1764]
NotebookOptionsPosition[    103137,       1710]
NotebookOutlinePosition[    103481,       1725]
CellTagsIndexPosition[    103438,       1722]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Demonstration of CAMPS Algorithm with NCI Example CT \
images.",
 FontColor->GrayLevel[0]]], "Title",
 CellChangeTimes->{{3.7372012479429293`*^9, 
  3.7372012868213034`*^9}},ExpressionUUID->"cf63d530-fc98-49be-8103-\
1cc4f150977e"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Preface",
 FontColor->GrayLevel[0]]], "Subsection",
 CellChangeTimes->{{3.749299712539586*^9, 
  3.7492997147137733`*^9}},ExpressionUUID->"3156649a-93a1-4a97-a818-\
57deef095930"],

Cell["\<\
This document is uploaded in both PDF format, and \[OpenCurlyDoubleQuote].nb\
\[CloseCurlyDoubleQuote] format. The PDF format cannot be run as a program.  \
If you have Wolfram Mathematica, you can view both the formated text, and \
execute the program.  In the PDF format, you will need to cut and paste the \
code sections into a separate text document, with the extension \
\[OpenCurlyDoubleQuote].nb\[CloseCurlyDoubleQuote].  There is some code \
included with traditional commenting tags.  Those commented lines/sections of \
code will not execute.  The additional lines of code are provided if you have \
the time and patience to wait for the program to process several files with \
resulting multiple stored intermediate images.  Processing 100 axial images \
with the display of intermediate images could easily take all night long, if \
the computer doesn\[CloseCurlyQuote]t crash from memory limitations.\
\>", "Text",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.720805209498361*^9, 3.7208054326769285`*^9}, {
   3.7252002379667253`*^9, 3.7252002702999244`*^9}, {3.7252003031712837`*^9, 
   3.7252003112856383`*^9}, {3.725200539599642*^9, 3.7252005505693703`*^9}, {
   3.7252014143799844`*^9, 3.725201432829694*^9}, {3.7252026135006948`*^9, 
   3.7252026214655104`*^9}, {3.7252032100095396`*^9, 
   3.7252032342938375`*^9}, {3.72520390718018*^9, 3.725203931049675*^9}, {
   3.7252954616179347`*^9, 3.7252954874223375`*^9}, {3.7252977791668625`*^9, 
   3.7252978120678096`*^9}, {3.725298390635613*^9, 3.7252984577119703`*^9}, {
   3.7252985370729513`*^9, 3.7252985378829637`*^9}, {3.7252989425681973`*^9, 
   3.7252989508432255`*^9}, {3.725299178068923*^9, 3.725299192363599*^9}, {
   3.725305631241751*^9, 3.725305631911832*^9}, {3.7253056766760283`*^9, 
   3.7253056811410007`*^9}, {3.725310143519206*^9, 3.725310157069401*^9}, {
   3.725311147414806*^9, 3.7253111581898985`*^9}, {3.7253114171942616`*^9, 
   3.725311420709257*^9}, {3.725311974552081*^9, 3.72531197507216*^9}, {
   3.725736671737455*^9, 3.725736695240221*^9}, {3.72573690107944*^9, 
   3.7257369071694803`*^9}, {3.7257373770035896`*^9, 3.725737386231642*^9}, {
   3.72573891864647*^9, 3.725738927836671*^9}, {3.7257394293855743`*^9, 
   3.7257394378708467`*^9}, {3.725796162399544*^9, 3.7257961699949155`*^9}, {
   3.725796626103148*^9, 3.7257966385945363`*^9}, {3.7257969901939983`*^9, 
   3.7257970041537943`*^9}, {3.7257978238913193`*^9, 
   3.7257978332336254`*^9}, {3.7257984133500967`*^9, 
   3.7257984230006027`*^9}, {3.7257986705488777`*^9, 3.725798682361902*^9}, {
   3.7257991899135733`*^9, 3.7257991904935102`*^9}, {3.7259012032605762`*^9, 
   3.7259012138508635`*^9}, {3.725901302161606*^9, 3.725901333394444*^9}, {
   3.7259019369769917`*^9, 3.725901956965429*^9}, {3.725902649172713*^9, 
   3.725902665932955*^9}, {3.725903093747491*^9, 3.7259031068223634`*^9}, {
   3.725903528625581*^9, 3.7259035365507526`*^9}, {3.725903643966039*^9, 
   3.7259036446260676`*^9}, {3.7259037154182043`*^9, 
   3.7259037188432083`*^9}, {3.725904029457999*^9, 3.7259040338878884`*^9}, {
   3.726335441804954*^9, 3.7263354503336544`*^9}, {3.7263360912058883`*^9, 
   3.7263360990059915`*^9}, {3.726336341561963*^9, 3.7263363517869396`*^9}, {
   3.7263400225096464`*^9, 3.72634003249949*^9}, {3.7263406788693657`*^9, 
   3.726340688409599*^9}, {3.726341195653415*^9, 3.726341205088403*^9}, {
   3.7268536798285584`*^9, 3.726853694482935*^9}, {3.7268545712596188`*^9, 
   3.7268545794095364`*^9}, {3.7268550388485665`*^9, 
   3.7268550505233183`*^9}, {3.726855546241809*^9, 3.726855556291871*^9}, {
   3.7268559809717283`*^9, 3.7268559932463617`*^9}, {3.726856304622264*^9, 
   3.7268563149076433`*^9}, {3.726856635846075*^9, 3.726856645337285*^9}, {
   3.7268570466058917`*^9, 3.726857053825994*^9}, {3.7268573695670276`*^9, 
   3.7268573771818686`*^9}, {3.7268579611223545`*^9, 
   3.7268579780767813`*^9}, {3.728757051408911*^9, 3.72875713663943*^9}, {
   3.7299449705611186`*^9, 3.7299449760008993`*^9}, {3.7299463656121564`*^9, 
   3.729946378111845*^9}, {3.729946819635265*^9, 3.729946829515012*^9}, {
   3.729947127069018*^9, 3.729947136829181*^9}, {3.7299474622924566`*^9, 
   3.7299474730913997`*^9}, {3.729947735399078*^9, 3.7299477446992164`*^9}, {
   3.729947956675452*^9, 3.729947966075102*^9}, {3.729948131579133*^9, 
   3.729948141328845*^9}, {3.729948732649169*^9, 3.7299487392941585`*^9}, {
   3.7299491615902395`*^9, 3.7299491701699724`*^9}, {3.7299493800283065`*^9, 
   3.7299493894636297`*^9}, {3.72996089578596*^9, 3.7299610247756805`*^9}, {
   3.729961505862711*^9, 3.7299615820853415`*^9}, {3.729964391826625*^9, 
   3.7299644032161875`*^9}, {3.729964712482403*^9, 3.72996472364237*^9}, {
   3.7299653402839108`*^9, 3.729965364290529*^9}, {3.7299657141131263`*^9, 
   3.729965723353034*^9}, {3.7299666880687475`*^9, 3.7299667019043293`*^9}, {
   3.7299669072257442`*^9, 3.7299669226153193`*^9}, {3.729967145761899*^9, 
   3.7299671578116302`*^9}, {3.72996743276167*^9, 3.7299674477310724`*^9}, {
   3.730026911031879*^9, 3.7300269217404423`*^9}, {3.7300271611188507`*^9, 
   3.7300271694236746`*^9}, {3.7300275321274157`*^9, 
   3.7300275416024857`*^9}, {3.7300278005292397`*^9, 
   3.7300278079593115`*^9}, {3.732831616463667*^9, 3.732831624561401*^9}, {
   3.732879422963066*^9, 3.7328794287721243`*^9}, {3.732887103225177*^9, 
   3.73288711985503*^9}, {3.732887307117558*^9, 3.732887316627488*^9}, {
   3.7328888496727176`*^9, 3.732888967446562*^9}, {3.7328937662543087`*^9, 
   3.7328937763920116`*^9}, {3.7328938635371313`*^9, 3.732893870428976*^9}, {
   3.732893986937827*^9, 3.7328939976456914`*^9}, {3.7328945560335803`*^9, 
   3.732894566513283*^9}, {3.732894692052242*^9, 3.7328947020825205`*^9}, {
   3.7328947950116377`*^9, 3.7328948065706124`*^9}, {3.7328948787516413`*^9, 
   3.7328948879063253`*^9}, {3.7328949532582307`*^9, 
   3.7328949589332113`*^9}, {3.7328955092839947`*^9, 3.732895522178528*^9}, {
   3.732895565446947*^9, 3.7328955747518144`*^9}, {3.7328956404390616`*^9, 
   3.7328956498289943`*^9}, {3.732895714726531*^9, 3.7328957236364274`*^9}, {
   3.7328957927484455`*^9, 3.7328958007103148`*^9}, {3.732895868020444*^9, 
   3.732895878025421*^9}, {3.732895944957489*^9, 3.7328959539773693`*^9}, {
   3.7328960576061277`*^9, 3.73289606554547*^9}, {3.732896149095929*^9, 
   3.732896158075964*^9}, {3.7328962573750744`*^9, 3.732896274684741*^9}, {
   3.7328963546561966`*^9, 3.7328963636009836`*^9}, {3.732896445925239*^9, 
   3.7328964587099996`*^9}, {3.732896545852193*^9, 3.7328965554021606`*^9}, {
   3.7328966504909873`*^9, 3.732896657890915*^9}, {3.7328967583717513`*^9, 
   3.732896767471707*^9}, {3.732896849076232*^9, 3.7328968560518894`*^9}, {
   3.732896936990875*^9, 3.732896945255695*^9}, {3.7328970193753057`*^9, 
   3.7328970280702057`*^9}, {3.7328970932282834`*^9, 3.732897101993493*^9}, {
   3.7328971844480286`*^9, 3.7328971945580893`*^9}, {3.7328972644117827`*^9, 
   3.732897272411796*^9}, {3.732897339403035*^9, 3.732897349022798*^9}, {
   3.7328974194613295`*^9, 3.7328974275164385`*^9}, {3.732897573749546*^9, 
   3.732897584149218*^9}, {3.732897671972499*^9, 3.7328976802823286`*^9}, {
   3.732897766676141*^9, 3.732897783610815*^9}, {3.732897852077343*^9, 
   3.732897862802062*^9}, {3.732897941046487*^9, 3.732897954251421*^9}, {
   3.732898130111085*^9, 3.732898137776148*^9}, {3.732898444134014*^9, 
   3.7328984568685284`*^9}, {3.7328985378626595`*^9, 3.732898547392453*^9}, {
   3.732898637313116*^9, 3.732898654578396*^9}, {3.7328987315863705`*^9, 
   3.7328987411761837`*^9}, {3.732898814480356*^9, 3.732898823540183*^9}, {
   3.732898896438599*^9, 3.7328989054537897`*^9}, {3.7329000332477894`*^9, 
   3.7329000413875446`*^9}, {3.732901393229869*^9, 3.7329014039800205`*^9}, {
   3.732901494570811*^9, 3.7329015020807467`*^9}, {3.733009580033913*^9, 
   3.733009581879031*^9}, {3.7330109877389793`*^9, 3.7330110696720524`*^9}, 
   3.7330853686256504`*^9, {3.7340233736295276`*^9, 3.734023402428831*^9}, {
   3.734023612709117*^9, 3.734023638923421*^9}, 3.7340236702391405`*^9, 
   3.734025704502059*^9, {3.734025747500244*^9, 3.7340257634393883`*^9}, {
   3.7340259269041195`*^9, 3.7340259665368423`*^9}, {3.7340307328013268`*^9, 
   3.734030749322783*^9}, {3.7340309989579735`*^9, 3.7340309998527875`*^9}, {
   3.734032546631898*^9, 3.7340325516919165`*^9}, {3.734037171921851*^9, 
   3.734037182856868*^9}, {3.734037237263196*^9, 3.7340372479982405`*^9}, {
   3.734037320696334*^9, 3.7340373290913286`*^9}, {3.7340374024057455`*^9, 
   3.7340374121858516`*^9}, {3.734037485302636*^9, 3.734037494797657*^9}, {
   3.734037560478919*^9, 3.734037569679203*^9}, {3.7340376346820335`*^9, 
   3.7340376424671*^9}, {3.7340378334162407`*^9, 3.734037841056549*^9}, {
   3.7340379146041265`*^9, 3.734037920029069*^9}, {3.7340379899110518`*^9, 
   3.7340380001260023`*^9}, {3.7340380689525337`*^9, 3.734038078842559*^9}, {
   3.7340381435638704`*^9, 3.7340381537189207`*^9}, {3.734038224082117*^9, 
   3.734038232002242*^9}, {3.734038300988067*^9, 3.734038308402877*^9}, {
   3.734038378339017*^9, 3.734038386134289*^9}, {3.734038446295672*^9, 
   3.7340384545356803`*^9}, {3.7340385162337475`*^9, 
   3.7340385256489935`*^9}, {3.7340385963554316`*^9, 
   3.7340386045655994`*^9}, {3.7340386636437707`*^9, 
   3.7340386728938828`*^9}, {3.734038744140399*^9, 3.734038753589913*^9}, {
   3.734038808448408*^9, 3.7340388167135553`*^9}, {3.7340388737866435`*^9, 
   3.7340388829966497`*^9}, {3.7340389530431204`*^9, 
   3.7340389597881975`*^9}, {3.7340390214876213`*^9, 
   3.7340390303726616`*^9}, {3.734039091589052*^9, 3.734039101789356*^9}, {
   3.7340391631870117`*^9, 3.7340391722371454`*^9}, {3.7340392384985714`*^9, 
   3.7340392461085234`*^9}, {3.7340393557203307`*^9, 
   3.7340393635204268`*^9}, {3.734039423428363*^9, 3.7340394319985104`*^9}, {
   3.734039493709517*^9, 3.7340395008998594`*^9}, {3.734039560882683*^9, 
   3.7340395698380566`*^9}, {3.734039627447457*^9, 3.7340396357174115`*^9}, {
   3.7340396945102377`*^9, 3.7340397015004005`*^9}, {3.734039831943036*^9, 
   3.734039845891075*^9}, {3.7340399380100565`*^9, 3.734039946145313*^9}, {
   3.7340401219579983`*^9, 3.7340401308182397`*^9}, {3.7340401957824774`*^9, 
   3.7340402035824547`*^9}, {3.734040274888051*^9, 3.734040283608266*^9}, {
   3.7340403360710483`*^9, 3.7340403440860734`*^9}, {3.7340404179419627`*^9, 
   3.734040426112172*^9}, {3.734040485224328*^9, 3.7340404944094977`*^9}, {
   3.7340405667155304`*^9, 3.73404057467065*^9}, {3.734040629084879*^9, 
   3.7340406380451374`*^9}, {3.734523245908614*^9, 3.734523308430374*^9}, {
   3.7345235458587437`*^9, 3.7345235763461323`*^9}, {3.734649332912223*^9, 
   3.7346493430019836`*^9}, {3.7346494320076103`*^9, 3.734649443357955*^9}, {
   3.734649623088647*^9, 3.7346496313835955`*^9}, {3.7346497137435265`*^9, 
   3.734649722178553*^9}, {3.7346497935302134`*^9, 3.7346498022202005`*^9}, {
   3.734649868719274*^9, 3.7346498761193104`*^9}, {3.7346499365563946`*^9, 
   3.734649944620283*^9}, {3.7346500113638163`*^9, 3.7346500204889126`*^9}, {
   3.7346500897327385`*^9, 3.73465009826799*^9}, {3.734650179349145*^9, 
   3.734650186894432*^9}, {3.7346502539633026`*^9, 3.734650259583354*^9}, {
   3.734650335705487*^9, 3.734650344475439*^9}, {3.734650428147414*^9, 
   3.7346504359524193`*^9}, {3.7346505013874016`*^9, 
   3.7346505130223646`*^9}, {3.734650602215355*^9, 3.734650609775277*^9}, {
   3.734650682373746*^9, 3.7346506892838635`*^9}, {3.734650755556369*^9, 
   3.7346507632263646`*^9}, {3.734650845865383*^9, 3.734650854084281*^9}, {
   3.7346509538026023`*^9, 3.734650963607527*^9}, {3.734651026237143*^9, 
   3.7346510393555984`*^9}, {3.7346511204767513`*^9, 3.734651130522726*^9}, {
   3.734651201294263*^9, 3.7346512097495995`*^9}, {3.734651290113412*^9, 
   3.7346513063745537`*^9}, {3.7346513691056223`*^9, 3.734651379696602*^9}, {
   3.7346514529861374`*^9, 3.7346514612619286`*^9}, {3.7346515359290123`*^9, 
   3.734651544749866*^9}, {3.734651615437511*^9, 3.7346516233794694`*^9}, {
   3.734651704590139*^9, 3.7346517128011827`*^9}, {3.734651776959097*^9, 
   3.7346517842450514`*^9}, {3.7346518602434225`*^9, 
   3.7346518680593967`*^9}, {3.734651925587318*^9, 3.734651932772091*^9}, {
   3.7346519901645985`*^9, 3.734651998959485*^9}, {3.734652060064142*^9, 
   3.73465206844411*^9}, {3.7346521328288665`*^9, 3.7346521441839094`*^9}, {
   3.734652202101719*^9, 3.734652209666669*^9}, {3.734652271073217*^9, 
   3.7346522775932846`*^9}, {3.7346523795531187`*^9, 3.734652387442948*^9}, {
   3.7346524645571117`*^9, 3.734652473285882*^9}, {3.734652541916098*^9, 
   3.734652550936026*^9}, {3.734652629755961*^9, 3.734652639220975*^9}, {
   3.734652701321437*^9, 3.734652709401354*^9}, {3.73465277652772*^9, 
   3.734652784097807*^9}, {3.734652853777909*^9, 3.734652866692814*^9}, {
   3.7346529407374516`*^9, 3.734652950472505*^9}, {3.7346530368351154`*^9, 
   3.734653046515175*^9}, {3.736287153920436*^9, 3.7362876389856586`*^9}, {
   3.736287669773321*^9, 3.736287737073059*^9}, {3.736287771197833*^9, 
   3.736287900179912*^9}, 3.7363269365422335`*^9, 3.7363270685634522`*^9, {
   3.7363296058463917`*^9, 3.736329625282758*^9}, {3.7363296912804985`*^9, 
   3.73632989063244*^9}, {3.736330017816497*^9, 3.7363300599411564`*^9}, {
   3.7363301983233185`*^9, 3.736330367115003*^9}, {3.7363303977230897`*^9, 
   3.7363304546320457`*^9}, {3.7363304977941833`*^9, 3.736330515617942*^9}, {
   3.736330596989983*^9, 3.7363306031470823`*^9}, {3.736330642038878*^9, 
   3.7363308626858883`*^9}, {3.736331090370245*^9, 3.7363311033870125`*^9}, {
   3.736331159264124*^9, 3.736331237271075*^9}, {3.7364255632644205`*^9, 
   3.736425612347741*^9}, {3.7372013132455063`*^9, 3.7372016998444824`*^9}, {
   3.7488776792202578`*^9, 3.7488778424129367`*^9}, {3.7488779760252275`*^9, 
   3.7488779779146395`*^9}, {3.7488780159706516`*^9, 
   3.7488780233896103`*^9}, {3.7492147441831627`*^9, 3.749215175083415*^9}, {
   3.749215257427363*^9, 3.7492154039447274`*^9}, {3.749215767515118*^9, 
   3.749215799671963*^9}, {3.749215890855253*^9, 3.7492162980228987`*^9}, 
   3.749216369322323*^9, {3.7492213898185377`*^9, 3.7492214288741713`*^9}, {
   3.7492218672737026`*^9, 3.7492219996146703`*^9}, {3.7492221750527396`*^9, 
   3.749222276666114*^9}, {3.7492223204501266`*^9, 3.749222339365554*^9}, {
   3.7492224967255144`*^9, 3.749223142304914*^9}, {3.749223218729682*^9, 
   3.749223277378924*^9}, {3.7492254134477863`*^9, 3.7492254405440845`*^9}, {
   3.7492344714696198`*^9, 3.7492346170023513`*^9}, {3.749234676431136*^9, 
   3.7492346993378844`*^9}, {3.749234755005754*^9, 3.749234847227302*^9}, {
   3.749235775921468*^9, 3.7492358418482523`*^9}, {3.7492934038596525`*^9, 
   3.749293434004422*^9}, {3.749296477321003*^9, 3.749296635023483*^9}, {
   3.7492967197330637`*^9, 3.749296933280302*^9}, {3.7492969993586884`*^9, 
   3.749297019415081*^9}, {3.749297061417816*^9, 3.7492974470769596`*^9}, {
   3.7492975974926357`*^9, 3.7492976070780163`*^9}, {3.7492976831570425`*^9, 
   3.74929782926746*^9}, {3.749298781626526*^9, 3.7492989924421186`*^9}, {
   3.7492990661158133`*^9, 3.7492993551781836`*^9}, {3.7492994989415083`*^9, 
   3.7492996861092305`*^9}, {3.7492997470912323`*^9, 3.749299749326302*^9}, 
   3.74929979231738*^9, 3.7492998860229216`*^9},
 TextJustification->
  0.25,ExpressionUUID->"2a974f0f-84b1-49ce-827f-ae6405b9ba9f"],

Cell[TextData[{
 "\n",
 StyleBox["Introduction", "Section",
  FontColor->GrayLevel[0]]
}], "Text",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.720805209498361*^9, 3.7208054326769285`*^9}, {
   3.7252002379667253`*^9, 3.7252002702999244`*^9}, {3.7252003031712837`*^9, 
   3.7252003112856383`*^9}, {3.725200539599642*^9, 3.7252005505693703`*^9}, {
   3.7252014143799844`*^9, 3.725201432829694*^9}, {3.7252026135006948`*^9, 
   3.7252026214655104`*^9}, {3.7252032100095396`*^9, 
   3.7252032342938375`*^9}, {3.72520390718018*^9, 3.725203931049675*^9}, {
   3.7252954616179347`*^9, 3.7252954874223375`*^9}, {3.7252977791668625`*^9, 
   3.7252978120678096`*^9}, {3.725298390635613*^9, 3.7252984577119703`*^9}, {
   3.7252985370729513`*^9, 3.7252985378829637`*^9}, {3.7252989425681973`*^9, 
   3.7252989508432255`*^9}, {3.725299178068923*^9, 3.725299192363599*^9}, {
   3.725305631241751*^9, 3.725305631911832*^9}, {3.7253056766760283`*^9, 
   3.7253056811410007`*^9}, {3.725310143519206*^9, 3.725310157069401*^9}, {
   3.725311147414806*^9, 3.7253111581898985`*^9}, {3.7253114171942616`*^9, 
   3.725311420709257*^9}, {3.725311974552081*^9, 3.72531197507216*^9}, {
   3.725736671737455*^9, 3.725736695240221*^9}, {3.72573690107944*^9, 
   3.7257369071694803`*^9}, {3.7257373770035896`*^9, 3.725737386231642*^9}, {
   3.72573891864647*^9, 3.725738927836671*^9}, {3.7257394293855743`*^9, 
   3.7257394378708467`*^9}, {3.725796162399544*^9, 3.7257961699949155`*^9}, {
   3.725796626103148*^9, 3.7257966385945363`*^9}, {3.7257969901939983`*^9, 
   3.7257970041537943`*^9}, {3.7257978238913193`*^9, 
   3.7257978332336254`*^9}, {3.7257984133500967`*^9, 
   3.7257984230006027`*^9}, {3.7257986705488777`*^9, 3.725798682361902*^9}, {
   3.7257991899135733`*^9, 3.7257991904935102`*^9}, {3.7259012032605762`*^9, 
   3.7259012138508635`*^9}, {3.725901302161606*^9, 3.725901333394444*^9}, {
   3.7259019369769917`*^9, 3.725901956965429*^9}, {3.725902649172713*^9, 
   3.725902665932955*^9}, {3.725903093747491*^9, 3.7259031068223634`*^9}, {
   3.725903528625581*^9, 3.7259035365507526`*^9}, {3.725903643966039*^9, 
   3.7259036446260676`*^9}, {3.7259037154182043`*^9, 
   3.7259037188432083`*^9}, {3.725904029457999*^9, 3.7259040338878884`*^9}, {
   3.726335441804954*^9, 3.7263354503336544`*^9}, {3.7263360912058883`*^9, 
   3.7263360990059915`*^9}, {3.726336341561963*^9, 3.7263363517869396`*^9}, {
   3.7263400225096464`*^9, 3.72634003249949*^9}, {3.7263406788693657`*^9, 
   3.726340688409599*^9}, {3.726341195653415*^9, 3.726341205088403*^9}, {
   3.7268536798285584`*^9, 3.726853694482935*^9}, {3.7268545712596188`*^9, 
   3.7268545794095364`*^9}, {3.7268550388485665`*^9, 
   3.7268550505233183`*^9}, {3.726855546241809*^9, 3.726855556291871*^9}, {
   3.7268559809717283`*^9, 3.7268559932463617`*^9}, {3.726856304622264*^9, 
   3.7268563149076433`*^9}, {3.726856635846075*^9, 3.726856645337285*^9}, {
   3.7268570466058917`*^9, 3.726857053825994*^9}, {3.7268573695670276`*^9, 
   3.7268573771818686`*^9}, {3.7268579611223545`*^9, 
   3.7268579780767813`*^9}, {3.728757051408911*^9, 3.72875713663943*^9}, {
   3.7299449705611186`*^9, 3.7299449760008993`*^9}, {3.7299463656121564`*^9, 
   3.729946378111845*^9}, {3.729946819635265*^9, 3.729946829515012*^9}, {
   3.729947127069018*^9, 3.729947136829181*^9}, {3.7299474622924566`*^9, 
   3.7299474730913997`*^9}, {3.729947735399078*^9, 3.7299477446992164`*^9}, {
   3.729947956675452*^9, 3.729947966075102*^9}, {3.729948131579133*^9, 
   3.729948141328845*^9}, {3.729948732649169*^9, 3.7299487392941585`*^9}, {
   3.7299491615902395`*^9, 3.7299491701699724`*^9}, {3.7299493800283065`*^9, 
   3.7299493894636297`*^9}, {3.72996089578596*^9, 3.7299610247756805`*^9}, {
   3.729961505862711*^9, 3.7299615820853415`*^9}, {3.729964391826625*^9, 
   3.7299644032161875`*^9}, {3.729964712482403*^9, 3.72996472364237*^9}, {
   3.7299653402839108`*^9, 3.729965364290529*^9}, {3.7299657141131263`*^9, 
   3.729965723353034*^9}, {3.7299666880687475`*^9, 3.7299667019043293`*^9}, {
   3.7299669072257442`*^9, 3.7299669226153193`*^9}, {3.729967145761899*^9, 
   3.7299671578116302`*^9}, {3.72996743276167*^9, 3.7299674477310724`*^9}, {
   3.730026911031879*^9, 3.7300269217404423`*^9}, {3.7300271611188507`*^9, 
   3.7300271694236746`*^9}, {3.7300275321274157`*^9, 
   3.7300275416024857`*^9}, {3.7300278005292397`*^9, 
   3.7300278079593115`*^9}, {3.732831616463667*^9, 3.732831624561401*^9}, {
   3.732879422963066*^9, 3.7328794287721243`*^9}, {3.732887103225177*^9, 
   3.73288711985503*^9}, {3.732887307117558*^9, 3.732887316627488*^9}, {
   3.7328888496727176`*^9, 3.732888967446562*^9}, {3.7328937662543087`*^9, 
   3.7328937763920116`*^9}, {3.7328938635371313`*^9, 3.732893870428976*^9}, {
   3.732893986937827*^9, 3.7328939976456914`*^9}, {3.7328945560335803`*^9, 
   3.732894566513283*^9}, {3.732894692052242*^9, 3.7328947020825205`*^9}, {
   3.7328947950116377`*^9, 3.7328948065706124`*^9}, {3.7328948787516413`*^9, 
   3.7328948879063253`*^9}, {3.7328949532582307`*^9, 
   3.7328949589332113`*^9}, {3.7328955092839947`*^9, 3.732895522178528*^9}, {
   3.732895565446947*^9, 3.7328955747518144`*^9}, {3.7328956404390616`*^9, 
   3.7328956498289943`*^9}, {3.732895714726531*^9, 3.7328957236364274`*^9}, {
   3.7328957927484455`*^9, 3.7328958007103148`*^9}, {3.732895868020444*^9, 
   3.732895878025421*^9}, {3.732895944957489*^9, 3.7328959539773693`*^9}, {
   3.7328960576061277`*^9, 3.73289606554547*^9}, {3.732896149095929*^9, 
   3.732896158075964*^9}, {3.7328962573750744`*^9, 3.732896274684741*^9}, {
   3.7328963546561966`*^9, 3.7328963636009836`*^9}, {3.732896445925239*^9, 
   3.7328964587099996`*^9}, {3.732896545852193*^9, 3.7328965554021606`*^9}, {
   3.7328966504909873`*^9, 3.732896657890915*^9}, {3.7328967583717513`*^9, 
   3.732896767471707*^9}, {3.732896849076232*^9, 3.7328968560518894`*^9}, {
   3.732896936990875*^9, 3.732896945255695*^9}, {3.7328970193753057`*^9, 
   3.7328970280702057`*^9}, {3.7328970932282834`*^9, 3.732897101993493*^9}, {
   3.7328971844480286`*^9, 3.7328971945580893`*^9}, {3.7328972644117827`*^9, 
   3.732897272411796*^9}, {3.732897339403035*^9, 3.732897349022798*^9}, {
   3.7328974194613295`*^9, 3.7328974275164385`*^9}, {3.732897573749546*^9, 
   3.732897584149218*^9}, {3.732897671972499*^9, 3.7328976802823286`*^9}, {
   3.732897766676141*^9, 3.732897783610815*^9}, {3.732897852077343*^9, 
   3.732897862802062*^9}, {3.732897941046487*^9, 3.732897954251421*^9}, {
   3.732898130111085*^9, 3.732898137776148*^9}, {3.732898444134014*^9, 
   3.7328984568685284`*^9}, {3.7328985378626595`*^9, 3.732898547392453*^9}, {
   3.732898637313116*^9, 3.732898654578396*^9}, {3.7328987315863705`*^9, 
   3.7328987411761837`*^9}, {3.732898814480356*^9, 3.732898823540183*^9}, {
   3.732898896438599*^9, 3.7328989054537897`*^9}, {3.7329000332477894`*^9, 
   3.7329000413875446`*^9}, {3.732901393229869*^9, 3.7329014039800205`*^9}, {
   3.732901494570811*^9, 3.7329015020807467`*^9}, {3.733009580033913*^9, 
   3.733009581879031*^9}, {3.7330109877389793`*^9, 3.7330110696720524`*^9}, 
   3.7330853686256504`*^9, {3.7340233736295276`*^9, 3.734023402428831*^9}, {
   3.734023612709117*^9, 3.734023638923421*^9}, 3.7340236702391405`*^9, 
   3.734025704502059*^9, {3.734025747500244*^9, 3.7340257634393883`*^9}, {
   3.7340259269041195`*^9, 3.7340259665368423`*^9}, {3.7340307328013268`*^9, 
   3.734030749322783*^9}, {3.7340309989579735`*^9, 3.7340309998527875`*^9}, {
   3.734032546631898*^9, 3.7340325516919165`*^9}, {3.734037171921851*^9, 
   3.734037182856868*^9}, {3.734037237263196*^9, 3.7340372479982405`*^9}, {
   3.734037320696334*^9, 3.7340373290913286`*^9}, {3.7340374024057455`*^9, 
   3.7340374121858516`*^9}, {3.734037485302636*^9, 3.734037494797657*^9}, {
   3.734037560478919*^9, 3.734037569679203*^9}, {3.7340376346820335`*^9, 
   3.7340376424671*^9}, {3.7340378334162407`*^9, 3.734037841056549*^9}, {
   3.7340379146041265`*^9, 3.734037920029069*^9}, {3.7340379899110518`*^9, 
   3.7340380001260023`*^9}, {3.7340380689525337`*^9, 3.734038078842559*^9}, {
   3.7340381435638704`*^9, 3.7340381537189207`*^9}, {3.734038224082117*^9, 
   3.734038232002242*^9}, {3.734038300988067*^9, 3.734038308402877*^9}, {
   3.734038378339017*^9, 3.734038386134289*^9}, {3.734038446295672*^9, 
   3.7340384545356803`*^9}, {3.7340385162337475`*^9, 
   3.7340385256489935`*^9}, {3.7340385963554316`*^9, 
   3.7340386045655994`*^9}, {3.7340386636437707`*^9, 
   3.7340386728938828`*^9}, {3.734038744140399*^9, 3.734038753589913*^9}, {
   3.734038808448408*^9, 3.7340388167135553`*^9}, {3.7340388737866435`*^9, 
   3.7340388829966497`*^9}, {3.7340389530431204`*^9, 
   3.7340389597881975`*^9}, {3.7340390214876213`*^9, 
   3.7340390303726616`*^9}, {3.734039091589052*^9, 3.734039101789356*^9}, {
   3.7340391631870117`*^9, 3.7340391722371454`*^9}, {3.7340392384985714`*^9, 
   3.7340392461085234`*^9}, {3.7340393557203307`*^9, 
   3.7340393635204268`*^9}, {3.734039423428363*^9, 3.7340394319985104`*^9}, {
   3.734039493709517*^9, 3.7340395008998594`*^9}, {3.734039560882683*^9, 
   3.7340395698380566`*^9}, {3.734039627447457*^9, 3.7340396357174115`*^9}, {
   3.7340396945102377`*^9, 3.7340397015004005`*^9}, {3.734039831943036*^9, 
   3.734039845891075*^9}, {3.7340399380100565`*^9, 3.734039946145313*^9}, {
   3.7340401219579983`*^9, 3.7340401308182397`*^9}, {3.7340401957824774`*^9, 
   3.7340402035824547`*^9}, {3.734040274888051*^9, 3.734040283608266*^9}, {
   3.7340403360710483`*^9, 3.7340403440860734`*^9}, {3.7340404179419627`*^9, 
   3.734040426112172*^9}, {3.734040485224328*^9, 3.7340404944094977`*^9}, {
   3.7340405667155304`*^9, 3.73404057467065*^9}, {3.734040629084879*^9, 
   3.7340406380451374`*^9}, {3.734523245908614*^9, 3.734523308430374*^9}, {
   3.7345235458587437`*^9, 3.7345235763461323`*^9}, {3.734649332912223*^9, 
   3.7346493430019836`*^9}, {3.7346494320076103`*^9, 3.734649443357955*^9}, {
   3.734649623088647*^9, 3.7346496313835955`*^9}, {3.7346497137435265`*^9, 
   3.734649722178553*^9}, {3.7346497935302134`*^9, 3.7346498022202005`*^9}, {
   3.734649868719274*^9, 3.7346498761193104`*^9}, {3.7346499365563946`*^9, 
   3.734649944620283*^9}, {3.7346500113638163`*^9, 3.7346500204889126`*^9}, {
   3.7346500897327385`*^9, 3.73465009826799*^9}, {3.734650179349145*^9, 
   3.734650186894432*^9}, {3.7346502539633026`*^9, 3.734650259583354*^9}, {
   3.734650335705487*^9, 3.734650344475439*^9}, {3.734650428147414*^9, 
   3.7346504359524193`*^9}, {3.7346505013874016`*^9, 
   3.7346505130223646`*^9}, {3.734650602215355*^9, 3.734650609775277*^9}, {
   3.734650682373746*^9, 3.7346506892838635`*^9}, {3.734650755556369*^9, 
   3.7346507632263646`*^9}, {3.734650845865383*^9, 3.734650854084281*^9}, {
   3.7346509538026023`*^9, 3.734650963607527*^9}, {3.734651026237143*^9, 
   3.7346510393555984`*^9}, {3.7346511204767513`*^9, 3.734651130522726*^9}, {
   3.734651201294263*^9, 3.7346512097495995`*^9}, {3.734651290113412*^9, 
   3.7346513063745537`*^9}, {3.7346513691056223`*^9, 3.734651379696602*^9}, {
   3.7346514529861374`*^9, 3.7346514612619286`*^9}, {3.7346515359290123`*^9, 
   3.734651544749866*^9}, {3.734651615437511*^9, 3.7346516233794694`*^9}, {
   3.734651704590139*^9, 3.7346517128011827`*^9}, {3.734651776959097*^9, 
   3.7346517842450514`*^9}, {3.7346518602434225`*^9, 
   3.7346518680593967`*^9}, {3.734651925587318*^9, 3.734651932772091*^9}, {
   3.7346519901645985`*^9, 3.734651998959485*^9}, {3.734652060064142*^9, 
   3.73465206844411*^9}, {3.7346521328288665`*^9, 3.7346521441839094`*^9}, {
   3.734652202101719*^9, 3.734652209666669*^9}, {3.734652271073217*^9, 
   3.7346522775932846`*^9}, {3.7346523795531187`*^9, 3.734652387442948*^9}, {
   3.7346524645571117`*^9, 3.734652473285882*^9}, {3.734652541916098*^9, 
   3.734652550936026*^9}, {3.734652629755961*^9, 3.734652639220975*^9}, {
   3.734652701321437*^9, 3.734652709401354*^9}, {3.73465277652772*^9, 
   3.734652784097807*^9}, {3.734652853777909*^9, 3.734652866692814*^9}, {
   3.7346529407374516`*^9, 3.734652950472505*^9}, {3.7346530368351154`*^9, 
   3.734653046515175*^9}, {3.736287153920436*^9, 3.7362876389856586`*^9}, {
   3.736287669773321*^9, 3.736287737073059*^9}, {3.736287771197833*^9, 
   3.736287900179912*^9}, 3.7363269365422335`*^9, 3.7363270685634522`*^9, {
   3.7363296058463917`*^9, 3.736329625282758*^9}, {3.7363296912804985`*^9, 
   3.73632989063244*^9}, {3.736330017816497*^9, 3.7363300599411564`*^9}, {
   3.7363301983233185`*^9, 3.736330367115003*^9}, {3.7363303977230897`*^9, 
   3.7363304546320457`*^9}, {3.7363304977941833`*^9, 3.736330515617942*^9}, {
   3.736330596989983*^9, 3.7363306031470823`*^9}, {3.736330642038878*^9, 
   3.7363308626858883`*^9}, {3.736331090370245*^9, 3.7363311033870125`*^9}, {
   3.736331159264124*^9, 3.736331237271075*^9}, {3.7364255632644205`*^9, 
   3.736425612347741*^9}, {3.7372013132455063`*^9, 3.7372016998444824`*^9}, {
   3.7488776792202578`*^9, 3.7488778424129367`*^9}, {3.7488779760252275`*^9, 
   3.7488779779146395`*^9}, {3.7488780159706516`*^9, 
   3.7488780233896103`*^9}, {3.7492147441831627`*^9, 3.749215175083415*^9}, {
   3.749215257427363*^9, 3.7492154039447274`*^9}, {3.749215767515118*^9, 
   3.749215799671963*^9}, {3.749215890855253*^9, 3.7492162980228987`*^9}, 
   3.749216369322323*^9, {3.7492213898185377`*^9, 3.7492214288741713`*^9}, {
   3.7492218672737026`*^9, 3.7492219996146703`*^9}, {3.7492221750527396`*^9, 
   3.749222276666114*^9}, {3.7492223204501266`*^9, 3.749222339365554*^9}, {
   3.7492224967255144`*^9, 3.749223142304914*^9}, {3.749223218729682*^9, 
   3.749223277378924*^9}, {3.7492254134477863`*^9, 3.7492254405440845`*^9}, {
   3.7492344714696198`*^9, 3.7492346170023513`*^9}, {3.749234676431136*^9, 
   3.7492346993378844`*^9}, {3.749234755005754*^9, 3.749234847227302*^9}, {
   3.749235775921468*^9, 3.7492358418482523`*^9}, {3.7492934038596525`*^9, 
   3.749293434004422*^9}, {3.749296477321003*^9, 3.749296635023483*^9}, {
   3.7492967197330637`*^9, 3.749296933280302*^9}, {3.7492969993586884`*^9, 
   3.749297019415081*^9}, {3.749297061417816*^9, 3.7492974470769596`*^9}, {
   3.7492975974926357`*^9, 3.7492976070780163`*^9}, {3.7492976831570425`*^9, 
   3.74929782926746*^9}, {3.749298781626526*^9, 3.7492989924421186`*^9}, {
   3.7492990661158133`*^9, 3.7492993551781836`*^9}, {3.7492994989415083`*^9, 
   3.7492996861092305`*^9}, {3.7492997470912323`*^9, 3.749299749326302*^9}, 
   3.74929979231738*^9, 3.749299893540821*^9},
 TextJustification->
  0.25,ExpressionUUID->"1324907e-7f82-47dc-b949-61d2372fe43f"],

Cell["\<\

The purpose of this document is to provided more detailed information about \
the Computer Automated Measurement Patient Size (CAMPS) algorithm for those \
with programming backgrounds.  The program is used to calculate SSDE \
described in publications from the AAPM (AAPM Report 204 and 220).  This \
notebook will also explain how this algorithm differs from other published \
algorithms.

The goal of the algorithm is to separate those pixels in the CT image which \
represent the patient's body, from external structures such as the table or \
clothing.  Based on the number and area of body pixels, the size of the \
patient can be related to the size of standardized CT phantoms used to \
calculate Size Specific Dose Estimates. The algorithm here relies on \
morphologic  image processing as described in Gonzalez text book on digital \
image processing.   The bulk of the algorithm processing occurs in one high \
level programming line, \"MorphologicalBinarize[image]\". External structures \
are excluded by \"DeleteSmallComponents[]\". To complete the pixel \
attenuation calculation, the FillingTransform[] is subsequently applied.

Other approaches have been published in the medical physics literature.  One \
such approach was published by Anam.  Anam developed and investigated an \
algorithm that produces very similar results to the CAMPS algorithm. The \
description of the algorithm includes thresholding, segmentation, edge \
detection, and contouring.   Many of those algorithms are also described \
under edge detection and image segmentation in the textbook by Gonzalez.  \
Gonzalez textbook algorithms have been made available in  Mathematica, \
MATLAB, Python, C++, and other languages.  The differences in algorithms (and \
compilers, interpreters, hardware) result in differences in computational \
speed.  The goal in this presentation of CAMPS and the associated pixel \
attenuation algorithm was to show efficient computation and reliability of \
computer automated calculation with manual results.  It is difficult to \
compare the efficiency of one algorithm to another because of all the \
variables between hardware and software.  Both approaches appear to be \
approximately equal.  

When I began programming the process of identifying the body pixels, I used \
edge detection methods I originally developed for a study on data compression \
through perimeter encoding of CT images.  As I continued to work on the \
algorithm (originally in C programming language, 28 years ago), I tried many \
different approaches with the various functions available in Mathematica.  In \
Mathematica, I found the simple morphologic approach more efficient.  There \
are many new algorithms that may increase the reliability of segmentation of \
images for more general application.   However, for CT axial images, the \
older more computationally efficient approach works quite well.  Older \
algorithms had to be more computationally efficient because of hardware \
limitations.  Newer algorithms tend to be less computationally efficient, but \
more suitable for application to many different types of images.  The \
availability of hardware based graphics processors has also increased, which \
facilitate algorithms that may be programmed as parallel processes.

The calculation of SSDE based on the morphologic image processing algorithms \
has been tested against clinical images.  The result was a more than adequate \
correlation with calculation of SSDE by operator measurement of diameters.

To use this program, you must download the example images from the NCI NBIA \
website. The images are available from \
https://imaging.nci.nih.gov/ncia/login.jsf

There is commented code included in this listing.  Removing the comment \
brackets will result in display of images showing the segmentation of the CT \
image.  The display of those image results will make the program run very \
slow.  If every image in a series of 100 axial CT images are displayed, the \
program could take nearly 1 hour.  There are definitely ways of speeding up \
the display of those images.   However, the only effort I was concerned with \
is the fast and effective calculation of SSDE.  




Try the following suggested steps for downloading individual images:
Select \"Search Images\".
Select in Collections \"Head-Neck Cetuximab-\"
Select \"0522c001\"
Look for Description \"AbdomenCT 5.0 B40s\"
Select \"Thumbnails\"
Scroll to page 10
Select \"View Image\" under 200
This depends on your browser, Select save or download, open download folder, \
copy downloaded \"*. dcm\" image to an empty folder you will use to contain a \
sequence of images.
Repeat the process for images 260,350.
the program is now ready to run.

There are lines/sections of code that are surrounded by commenting tags, \
\"(*)\" in Mathematica.  Those lines/sections of code can be executed by \
uncommenting them.  However, the execution will be significantly slower.\
\>", "Text",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.720805209498361*^9, 3.7208054326769285`*^9}, {
   3.7252002379667253`*^9, 3.7252002702999244`*^9}, {3.7252003031712837`*^9, 
   3.7252003112856383`*^9}, {3.725200539599642*^9, 3.7252005505693703`*^9}, {
   3.7252014143799844`*^9, 3.725201432829694*^9}, {3.7252026135006948`*^9, 
   3.7252026214655104`*^9}, {3.7252032100095396`*^9, 
   3.7252032342938375`*^9}, {3.72520390718018*^9, 3.725203931049675*^9}, {
   3.7252954616179347`*^9, 3.7252954874223375`*^9}, {3.7252977791668625`*^9, 
   3.7252978120678096`*^9}, {3.725298390635613*^9, 3.7252984577119703`*^9}, {
   3.7252985370729513`*^9, 3.7252985378829637`*^9}, {3.7252989425681973`*^9, 
   3.7252989508432255`*^9}, {3.725299178068923*^9, 3.725299192363599*^9}, {
   3.725305631241751*^9, 3.725305631911832*^9}, {3.7253056766760283`*^9, 
   3.7253056811410007`*^9}, {3.725310143519206*^9, 3.725310157069401*^9}, {
   3.725311147414806*^9, 3.7253111581898985`*^9}, {3.7253114171942616`*^9, 
   3.725311420709257*^9}, {3.725311974552081*^9, 3.72531197507216*^9}, {
   3.725736671737455*^9, 3.725736695240221*^9}, {3.72573690107944*^9, 
   3.7257369071694803`*^9}, {3.7257373770035896`*^9, 3.725737386231642*^9}, {
   3.72573891864647*^9, 3.725738927836671*^9}, {3.7257394293855743`*^9, 
   3.7257394378708467`*^9}, {3.725796162399544*^9, 3.7257961699949155`*^9}, {
   3.725796626103148*^9, 3.7257966385945363`*^9}, {3.7257969901939983`*^9, 
   3.7257970041537943`*^9}, {3.7257978238913193`*^9, 
   3.7257978332336254`*^9}, {3.7257984133500967`*^9, 
   3.7257984230006027`*^9}, {3.7257986705488777`*^9, 3.725798682361902*^9}, {
   3.7257991899135733`*^9, 3.7257991904935102`*^9}, {3.7259012032605762`*^9, 
   3.7259012138508635`*^9}, {3.725901302161606*^9, 3.725901333394444*^9}, {
   3.7259019369769917`*^9, 3.725901956965429*^9}, {3.725902649172713*^9, 
   3.725902665932955*^9}, {3.725903093747491*^9, 3.7259031068223634`*^9}, {
   3.725903528625581*^9, 3.7259035365507526`*^9}, {3.725903643966039*^9, 
   3.7259036446260676`*^9}, {3.7259037154182043`*^9, 
   3.7259037188432083`*^9}, {3.725904029457999*^9, 3.7259040338878884`*^9}, {
   3.726335441804954*^9, 3.7263354503336544`*^9}, {3.7263360912058883`*^9, 
   3.7263360990059915`*^9}, {3.726336341561963*^9, 3.7263363517869396`*^9}, {
   3.7263400225096464`*^9, 3.72634003249949*^9}, {3.7263406788693657`*^9, 
   3.726340688409599*^9}, {3.726341195653415*^9, 3.726341205088403*^9}, {
   3.7268536798285584`*^9, 3.726853694482935*^9}, {3.7268545712596188`*^9, 
   3.7268545794095364`*^9}, {3.7268550388485665`*^9, 
   3.7268550505233183`*^9}, {3.726855546241809*^9, 3.726855556291871*^9}, {
   3.7268559809717283`*^9, 3.7268559932463617`*^9}, {3.726856304622264*^9, 
   3.7268563149076433`*^9}, {3.726856635846075*^9, 3.726856645337285*^9}, {
   3.7268570466058917`*^9, 3.726857053825994*^9}, {3.7268573695670276`*^9, 
   3.7268573771818686`*^9}, {3.7268579611223545`*^9, 
   3.7268579780767813`*^9}, {3.728757051408911*^9, 3.72875713663943*^9}, {
   3.7299449705611186`*^9, 3.7299449760008993`*^9}, {3.7299463656121564`*^9, 
   3.729946378111845*^9}, {3.729946819635265*^9, 3.729946829515012*^9}, {
   3.729947127069018*^9, 3.729947136829181*^9}, {3.7299474622924566`*^9, 
   3.7299474730913997`*^9}, {3.729947735399078*^9, 3.7299477446992164`*^9}, {
   3.729947956675452*^9, 3.729947966075102*^9}, {3.729948131579133*^9, 
   3.729948141328845*^9}, {3.729948732649169*^9, 3.7299487392941585`*^9}, {
   3.7299491615902395`*^9, 3.7299491701699724`*^9}, {3.7299493800283065`*^9, 
   3.7299493894636297`*^9}, {3.72996089578596*^9, 3.7299610247756805`*^9}, {
   3.729961505862711*^9, 3.7299615820853415`*^9}, {3.729964391826625*^9, 
   3.7299644032161875`*^9}, {3.729964712482403*^9, 3.72996472364237*^9}, {
   3.7299653402839108`*^9, 3.729965364290529*^9}, {3.7299657141131263`*^9, 
   3.729965723353034*^9}, {3.7299666880687475`*^9, 3.7299667019043293`*^9}, {
   3.7299669072257442`*^9, 3.7299669226153193`*^9}, {3.729967145761899*^9, 
   3.7299671578116302`*^9}, {3.72996743276167*^9, 3.7299674477310724`*^9}, {
   3.730026911031879*^9, 3.7300269217404423`*^9}, {3.7300271611188507`*^9, 
   3.7300271694236746`*^9}, {3.7300275321274157`*^9, 
   3.7300275416024857`*^9}, {3.7300278005292397`*^9, 
   3.7300278079593115`*^9}, {3.732831616463667*^9, 3.732831624561401*^9}, {
   3.732879422963066*^9, 3.7328794287721243`*^9}, {3.732887103225177*^9, 
   3.73288711985503*^9}, {3.732887307117558*^9, 3.732887316627488*^9}, {
   3.7328888496727176`*^9, 3.732888967446562*^9}, {3.7328937662543087`*^9, 
   3.7328937763920116`*^9}, {3.7328938635371313`*^9, 3.732893870428976*^9}, {
   3.732893986937827*^9, 3.7328939976456914`*^9}, {3.7328945560335803`*^9, 
   3.732894566513283*^9}, {3.732894692052242*^9, 3.7328947020825205`*^9}, {
   3.7328947950116377`*^9, 3.7328948065706124`*^9}, {3.7328948787516413`*^9, 
   3.7328948879063253`*^9}, {3.7328949532582307`*^9, 
   3.7328949589332113`*^9}, {3.7328955092839947`*^9, 3.732895522178528*^9}, {
   3.732895565446947*^9, 3.7328955747518144`*^9}, {3.7328956404390616`*^9, 
   3.7328956498289943`*^9}, {3.732895714726531*^9, 3.7328957236364274`*^9}, {
   3.7328957927484455`*^9, 3.7328958007103148`*^9}, {3.732895868020444*^9, 
   3.732895878025421*^9}, {3.732895944957489*^9, 3.7328959539773693`*^9}, {
   3.7328960576061277`*^9, 3.73289606554547*^9}, {3.732896149095929*^9, 
   3.732896158075964*^9}, {3.7328962573750744`*^9, 3.732896274684741*^9}, {
   3.7328963546561966`*^9, 3.7328963636009836`*^9}, {3.732896445925239*^9, 
   3.7328964587099996`*^9}, {3.732896545852193*^9, 3.7328965554021606`*^9}, {
   3.7328966504909873`*^9, 3.732896657890915*^9}, {3.7328967583717513`*^9, 
   3.732896767471707*^9}, {3.732896849076232*^9, 3.7328968560518894`*^9}, {
   3.732896936990875*^9, 3.732896945255695*^9}, {3.7328970193753057`*^9, 
   3.7328970280702057`*^9}, {3.7328970932282834`*^9, 3.732897101993493*^9}, {
   3.7328971844480286`*^9, 3.7328971945580893`*^9}, {3.7328972644117827`*^9, 
   3.732897272411796*^9}, {3.732897339403035*^9, 3.732897349022798*^9}, {
   3.7328974194613295`*^9, 3.7328974275164385`*^9}, {3.732897573749546*^9, 
   3.732897584149218*^9}, {3.732897671972499*^9, 3.7328976802823286`*^9}, {
   3.732897766676141*^9, 3.732897783610815*^9}, {3.732897852077343*^9, 
   3.732897862802062*^9}, {3.732897941046487*^9, 3.732897954251421*^9}, {
   3.732898130111085*^9, 3.732898137776148*^9}, {3.732898444134014*^9, 
   3.7328984568685284`*^9}, {3.7328985378626595`*^9, 3.732898547392453*^9}, {
   3.732898637313116*^9, 3.732898654578396*^9}, {3.7328987315863705`*^9, 
   3.7328987411761837`*^9}, {3.732898814480356*^9, 3.732898823540183*^9}, {
   3.732898896438599*^9, 3.7328989054537897`*^9}, {3.7329000332477894`*^9, 
   3.7329000413875446`*^9}, {3.732901393229869*^9, 3.7329014039800205`*^9}, {
   3.732901494570811*^9, 3.7329015020807467`*^9}, {3.733009580033913*^9, 
   3.733009581879031*^9}, {3.7330109877389793`*^9, 3.7330110696720524`*^9}, 
   3.7330853686256504`*^9, {3.7340233736295276`*^9, 3.734023402428831*^9}, {
   3.734023612709117*^9, 3.734023638923421*^9}, 3.7340236702391405`*^9, 
   3.734025704502059*^9, {3.734025747500244*^9, 3.7340257634393883`*^9}, {
   3.7340259269041195`*^9, 3.7340259665368423`*^9}, {3.7340307328013268`*^9, 
   3.734030749322783*^9}, {3.7340309989579735`*^9, 3.7340309998527875`*^9}, {
   3.734032546631898*^9, 3.7340325516919165`*^9}, {3.734037171921851*^9, 
   3.734037182856868*^9}, {3.734037237263196*^9, 3.7340372479982405`*^9}, {
   3.734037320696334*^9, 3.7340373290913286`*^9}, {3.7340374024057455`*^9, 
   3.7340374121858516`*^9}, {3.734037485302636*^9, 3.734037494797657*^9}, {
   3.734037560478919*^9, 3.734037569679203*^9}, {3.7340376346820335`*^9, 
   3.7340376424671*^9}, {3.7340378334162407`*^9, 3.734037841056549*^9}, {
   3.7340379146041265`*^9, 3.734037920029069*^9}, {3.7340379899110518`*^9, 
   3.7340380001260023`*^9}, {3.7340380689525337`*^9, 3.734038078842559*^9}, {
   3.7340381435638704`*^9, 3.7340381537189207`*^9}, {3.734038224082117*^9, 
   3.734038232002242*^9}, {3.734038300988067*^9, 3.734038308402877*^9}, {
   3.734038378339017*^9, 3.734038386134289*^9}, {3.734038446295672*^9, 
   3.7340384545356803`*^9}, {3.7340385162337475`*^9, 
   3.7340385256489935`*^9}, {3.7340385963554316`*^9, 
   3.7340386045655994`*^9}, {3.7340386636437707`*^9, 
   3.7340386728938828`*^9}, {3.734038744140399*^9, 3.734038753589913*^9}, {
   3.734038808448408*^9, 3.7340388167135553`*^9}, {3.7340388737866435`*^9, 
   3.7340388829966497`*^9}, {3.7340389530431204`*^9, 
   3.7340389597881975`*^9}, {3.7340390214876213`*^9, 
   3.7340390303726616`*^9}, {3.734039091589052*^9, 3.734039101789356*^9}, {
   3.7340391631870117`*^9, 3.7340391722371454`*^9}, {3.7340392384985714`*^9, 
   3.7340392461085234`*^9}, {3.7340393557203307`*^9, 
   3.7340393635204268`*^9}, {3.734039423428363*^9, 3.7340394319985104`*^9}, {
   3.734039493709517*^9, 3.7340395008998594`*^9}, {3.734039560882683*^9, 
   3.7340395698380566`*^9}, {3.734039627447457*^9, 3.7340396357174115`*^9}, {
   3.7340396945102377`*^9, 3.7340397015004005`*^9}, {3.734039831943036*^9, 
   3.734039845891075*^9}, {3.7340399380100565`*^9, 3.734039946145313*^9}, {
   3.7340401219579983`*^9, 3.7340401308182397`*^9}, {3.7340401957824774`*^9, 
   3.7340402035824547`*^9}, {3.734040274888051*^9, 3.734040283608266*^9}, {
   3.7340403360710483`*^9, 3.7340403440860734`*^9}, {3.7340404179419627`*^9, 
   3.734040426112172*^9}, {3.734040485224328*^9, 3.7340404944094977`*^9}, {
   3.7340405667155304`*^9, 3.73404057467065*^9}, {3.734040629084879*^9, 
   3.7340406380451374`*^9}, {3.734523245908614*^9, 3.734523308430374*^9}, {
   3.7345235458587437`*^9, 3.7345235763461323`*^9}, {3.734649332912223*^9, 
   3.7346493430019836`*^9}, {3.7346494320076103`*^9, 3.734649443357955*^9}, {
   3.734649623088647*^9, 3.7346496313835955`*^9}, {3.7346497137435265`*^9, 
   3.734649722178553*^9}, {3.7346497935302134`*^9, 3.7346498022202005`*^9}, {
   3.734649868719274*^9, 3.7346498761193104`*^9}, {3.7346499365563946`*^9, 
   3.734649944620283*^9}, {3.7346500113638163`*^9, 3.7346500204889126`*^9}, {
   3.7346500897327385`*^9, 3.73465009826799*^9}, {3.734650179349145*^9, 
   3.734650186894432*^9}, {3.7346502539633026`*^9, 3.734650259583354*^9}, {
   3.734650335705487*^9, 3.734650344475439*^9}, {3.734650428147414*^9, 
   3.7346504359524193`*^9}, {3.7346505013874016`*^9, 
   3.7346505130223646`*^9}, {3.734650602215355*^9, 3.734650609775277*^9}, {
   3.734650682373746*^9, 3.7346506892838635`*^9}, {3.734650755556369*^9, 
   3.7346507632263646`*^9}, {3.734650845865383*^9, 3.734650854084281*^9}, {
   3.7346509538026023`*^9, 3.734650963607527*^9}, {3.734651026237143*^9, 
   3.7346510393555984`*^9}, {3.7346511204767513`*^9, 3.734651130522726*^9}, {
   3.734651201294263*^9, 3.7346512097495995`*^9}, {3.734651290113412*^9, 
   3.7346513063745537`*^9}, {3.7346513691056223`*^9, 3.734651379696602*^9}, {
   3.7346514529861374`*^9, 3.7346514612619286`*^9}, {3.7346515359290123`*^9, 
   3.734651544749866*^9}, {3.734651615437511*^9, 3.7346516233794694`*^9}, {
   3.734651704590139*^9, 3.7346517128011827`*^9}, {3.734651776959097*^9, 
   3.7346517842450514`*^9}, {3.7346518602434225`*^9, 
   3.7346518680593967`*^9}, {3.734651925587318*^9, 3.734651932772091*^9}, {
   3.7346519901645985`*^9, 3.734651998959485*^9}, {3.734652060064142*^9, 
   3.73465206844411*^9}, {3.7346521328288665`*^9, 3.7346521441839094`*^9}, {
   3.734652202101719*^9, 3.734652209666669*^9}, {3.734652271073217*^9, 
   3.7346522775932846`*^9}, {3.7346523795531187`*^9, 3.734652387442948*^9}, {
   3.7346524645571117`*^9, 3.734652473285882*^9}, {3.734652541916098*^9, 
   3.734652550936026*^9}, {3.734652629755961*^9, 3.734652639220975*^9}, {
   3.734652701321437*^9, 3.734652709401354*^9}, {3.73465277652772*^9, 
   3.734652784097807*^9}, {3.734652853777909*^9, 3.734652866692814*^9}, {
   3.7346529407374516`*^9, 3.734652950472505*^9}, {3.7346530368351154`*^9, 
   3.734653046515175*^9}, {3.736287153920436*^9, 3.7362876389856586`*^9}, {
   3.736287669773321*^9, 3.736287737073059*^9}, {3.736287771197833*^9, 
   3.736287900179912*^9}, 3.7363269365422335`*^9, 3.7363270685634522`*^9, {
   3.7363296058463917`*^9, 3.736329625282758*^9}, {3.7363296912804985`*^9, 
   3.73632989063244*^9}, {3.736330017816497*^9, 3.7363300599411564`*^9}, {
   3.7363301983233185`*^9, 3.736330367115003*^9}, {3.7363303977230897`*^9, 
   3.7363304546320457`*^9}, {3.7363304977941833`*^9, 3.736330515617942*^9}, {
   3.736330596989983*^9, 3.7363306031470823`*^9}, {3.736330642038878*^9, 
   3.7363308626858883`*^9}, {3.736331090370245*^9, 3.7363311033870125`*^9}, {
   3.736331159264124*^9, 3.736331237271075*^9}, {3.7364255632644205`*^9, 
   3.736425612347741*^9}, {3.7372013132455063`*^9, 3.7372016998444824`*^9}, {
   3.7488776792202578`*^9, 3.7488778424129367`*^9}, {3.7488779760252275`*^9, 
   3.7488779779146395`*^9}, {3.7488780159706516`*^9, 
   3.7488780233896103`*^9}, {3.7492147441831627`*^9, 3.749215175083415*^9}, {
   3.749215257427363*^9, 3.7492154039447274`*^9}, {3.749215767515118*^9, 
   3.749215799671963*^9}, {3.749215890855253*^9, 3.7492162980228987`*^9}, 
   3.749216369322323*^9, {3.7492213898185377`*^9, 3.7492214288741713`*^9}, {
   3.7492218672737026`*^9, 3.7492219996146703`*^9}, {3.7492221750527396`*^9, 
   3.749222276666114*^9}, {3.7492223204501266`*^9, 3.749222339365554*^9}, {
   3.7492224967255144`*^9, 3.749223142304914*^9}, {3.749223218729682*^9, 
   3.749223277378924*^9}, {3.7492254134477863`*^9, 3.7492254405440845`*^9}, {
   3.7492344714696198`*^9, 3.7492346170023513`*^9}, {3.749234676431136*^9, 
   3.7492346993378844`*^9}, {3.749234755005754*^9, 3.749234847227302*^9}, {
   3.749235775921468*^9, 3.7492358418482523`*^9}, {3.7492934038596525`*^9, 
   3.749293434004422*^9}, {3.749296477321003*^9, 3.749296635023483*^9}, {
   3.7492967197330637`*^9, 3.749296933280302*^9}, {3.7492969993586884`*^9, 
   3.749297019415081*^9}, {3.749297061417816*^9, 3.7492974470769596`*^9}, {
   3.7492975974926357`*^9, 3.7492976070780163`*^9}, {3.7492976831570425`*^9, 
   3.74929782926746*^9}, {3.749298781626526*^9, 3.7492989924421186`*^9}, {
   3.7492990661158133`*^9, 3.7492993551781836`*^9}, {3.7492994989415083`*^9, 
   3.7492996861092305`*^9}, {3.7492997470912323`*^9, 3.749299749326302*^9}, 
   3.74929979231738*^9, {3.749299971194644*^9, 3.7492999722179055`*^9}, {
   3.751650079839363*^9, 3.7516503015126*^9}, {3.751650397830989*^9, 
   3.7516506608631325`*^9}, {3.751650775780989*^9, 3.7516507768589067`*^9}, {
   3.751650838813613*^9, 3.751650993277749*^9}},
 TextJustification->
  0.25,ExpressionUUID->"f7551c07-98b6-4908-aca9-38ec6a581602"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"convfactor32", "[", "z_", "]"}], ":=", 
    RowBox[{"3.704369", "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "0.03671937"}], "*", "z"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"From", " ", "AAPM", " ", "Report", " ", "204"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.720805209498361*^9, 3.7208054326769285`*^9}, {
   3.7252002379667253`*^9, 3.7252002702999244`*^9}, {3.7252003031712837`*^9, 
   3.7252003112856383`*^9}, {3.725200539599642*^9, 3.7252005505693703`*^9}, {
   3.7252014143799844`*^9, 3.725201432829694*^9}, {3.7252026135006948`*^9, 
   3.7252026214655104`*^9}, {3.7252032100095396`*^9, 
   3.7252032342938375`*^9}, {3.72520390718018*^9, 3.725203931049675*^9}, {
   3.7252954616179347`*^9, 3.7252954874223375`*^9}, {3.7252977791668625`*^9, 
   3.7252978120678096`*^9}, {3.725298390635613*^9, 3.7252984577119703`*^9}, {
   3.7252985370729513`*^9, 3.7252985378829637`*^9}, {3.7252989425681973`*^9, 
   3.7252989508432255`*^9}, {3.725299178068923*^9, 3.725299192363599*^9}, {
   3.725305631241751*^9, 3.725305631911832*^9}, {3.7253056766760283`*^9, 
   3.7253056811410007`*^9}, {3.725310143519206*^9, 3.725310157069401*^9}, {
   3.725311147414806*^9, 3.7253111581898985`*^9}, {3.7253114171942616`*^9, 
   3.725311420709257*^9}, {3.725311974552081*^9, 3.72531197507216*^9}, {
   3.725736671737455*^9, 3.725736695240221*^9}, {3.72573690107944*^9, 
   3.7257369071694803`*^9}, {3.7257373770035896`*^9, 3.725737386231642*^9}, {
   3.72573891864647*^9, 3.725738927836671*^9}, {3.7257394293855743`*^9, 
   3.7257394378708467`*^9}, {3.725796162399544*^9, 3.7257961699949155`*^9}, {
   3.725796626103148*^9, 3.7257966385945363`*^9}, {3.7257969901939983`*^9, 
   3.7257970041537943`*^9}, {3.7257978238913193`*^9, 
   3.7257978332336254`*^9}, {3.7257984133500967`*^9, 
   3.7257984230006027`*^9}, {3.7257986705488777`*^9, 3.725798682361902*^9}, {
   3.7257991899135733`*^9, 3.7257991904935102`*^9}, {3.7259012032605762`*^9, 
   3.7259012138508635`*^9}, {3.725901302161606*^9, 3.725901333394444*^9}, {
   3.7259019369769917`*^9, 3.725901956965429*^9}, {3.725902649172713*^9, 
   3.725902665932955*^9}, {3.725903093747491*^9, 3.7259031068223634`*^9}, {
   3.725903528625581*^9, 3.7259035365507526`*^9}, {3.725903643966039*^9, 
   3.7259036446260676`*^9}, {3.7259037154182043`*^9, 
   3.7259037188432083`*^9}, {3.725904029457999*^9, 3.7259040338878884`*^9}, {
   3.726335441804954*^9, 3.7263354503336544`*^9}, {3.7263360912058883`*^9, 
   3.7263360990059915`*^9}, {3.726336341561963*^9, 3.7263363517869396`*^9}, {
   3.7263400225096464`*^9, 3.72634003249949*^9}, {3.7263406788693657`*^9, 
   3.726340688409599*^9}, {3.726341195653415*^9, 3.726341205088403*^9}, {
   3.7268536798285584`*^9, 3.726853694482935*^9}, {3.7268545712596188`*^9, 
   3.7268545794095364`*^9}, {3.7268550388485665`*^9, 
   3.7268550505233183`*^9}, {3.726855546241809*^9, 3.726855556291871*^9}, {
   3.7268559809717283`*^9, 3.7268559932463617`*^9}, {3.726856304622264*^9, 
   3.7268563149076433`*^9}, {3.726856635846075*^9, 3.726856645337285*^9}, {
   3.7268570466058917`*^9, 3.726857053825994*^9}, {3.7268573695670276`*^9, 
   3.7268573771818686`*^9}, {3.7268579611223545`*^9, 
   3.7268579780767813`*^9}, {3.728757051408911*^9, 3.72875713663943*^9}, {
   3.7299449705611186`*^9, 3.7299449760008993`*^9}, {3.7299463656121564`*^9, 
   3.729946378111845*^9}, {3.729946819635265*^9, 3.729946829515012*^9}, {
   3.729947127069018*^9, 3.729947136829181*^9}, {3.7299474622924566`*^9, 
   3.7299474730913997`*^9}, {3.729947735399078*^9, 3.7299477446992164`*^9}, {
   3.729947956675452*^9, 3.729947966075102*^9}, {3.729948131579133*^9, 
   3.729948141328845*^9}, {3.729948732649169*^9, 3.7299487392941585`*^9}, {
   3.7299491615902395`*^9, 3.7299491701699724`*^9}, {3.7299493800283065`*^9, 
   3.7299493894636297`*^9}, {3.72996089578596*^9, 3.7299610247756805`*^9}, {
   3.729961505862711*^9, 3.7299615820853415`*^9}, {3.729964391826625*^9, 
   3.7299644032161875`*^9}, {3.729964712482403*^9, 3.72996472364237*^9}, {
   3.7299653402839108`*^9, 3.729965364290529*^9}, {3.7299657141131263`*^9, 
   3.729965723353034*^9}, {3.7299666880687475`*^9, 3.7299667019043293`*^9}, {
   3.7299669072257442`*^9, 3.7299669226153193`*^9}, {3.729967145761899*^9, 
   3.7299671578116302`*^9}, {3.72996743276167*^9, 3.7299674477310724`*^9}, {
   3.730026911031879*^9, 3.7300269217404423`*^9}, {3.7300271611188507`*^9, 
   3.7300271694236746`*^9}, {3.7300275321274157`*^9, 
   3.7300275416024857`*^9}, {3.7300278005292397`*^9, 
   3.7300278079593115`*^9}, {3.732831616463667*^9, 3.732831624561401*^9}, {
   3.732879422963066*^9, 3.7328794287721243`*^9}, {3.732887103225177*^9, 
   3.73288711985503*^9}, {3.732887307117558*^9, 3.732887316627488*^9}, {
   3.7328888496727176`*^9, 3.732888967446562*^9}, {3.7328937662543087`*^9, 
   3.7328937763920116`*^9}, {3.7328938635371313`*^9, 3.732893870428976*^9}, {
   3.732893986937827*^9, 3.7328939976456914`*^9}, {3.7328945560335803`*^9, 
   3.732894566513283*^9}, {3.732894692052242*^9, 3.7328947020825205`*^9}, {
   3.7328947950116377`*^9, 3.7328948065706124`*^9}, {3.7328948787516413`*^9, 
   3.7328948879063253`*^9}, {3.7328949532582307`*^9, 
   3.7328949589332113`*^9}, {3.7328955092839947`*^9, 3.732895522178528*^9}, {
   3.732895565446947*^9, 3.7328955747518144`*^9}, {3.7328956404390616`*^9, 
   3.7328956498289943`*^9}, {3.732895714726531*^9, 3.7328957236364274`*^9}, {
   3.7328957927484455`*^9, 3.7328958007103148`*^9}, {3.732895868020444*^9, 
   3.732895878025421*^9}, {3.732895944957489*^9, 3.7328959539773693`*^9}, {
   3.7328960576061277`*^9, 3.73289606554547*^9}, {3.732896149095929*^9, 
   3.732896158075964*^9}, {3.7328962573750744`*^9, 3.732896274684741*^9}, {
   3.7328963546561966`*^9, 3.7328963636009836`*^9}, {3.732896445925239*^9, 
   3.7328964587099996`*^9}, {3.732896545852193*^9, 3.7328965554021606`*^9}, {
   3.7328966504909873`*^9, 3.732896657890915*^9}, {3.7328967583717513`*^9, 
   3.732896767471707*^9}, {3.732896849076232*^9, 3.7328968560518894`*^9}, {
   3.732896936990875*^9, 3.732896945255695*^9}, {3.7328970193753057`*^9, 
   3.7328970280702057`*^9}, {3.7328970932282834`*^9, 3.732897101993493*^9}, {
   3.7328971844480286`*^9, 3.7328971945580893`*^9}, {3.7328972644117827`*^9, 
   3.732897272411796*^9}, {3.732897339403035*^9, 3.732897349022798*^9}, {
   3.7328974194613295`*^9, 3.7328974275164385`*^9}, {3.732897573749546*^9, 
   3.732897584149218*^9}, {3.732897671972499*^9, 3.7328976802823286`*^9}, {
   3.732897766676141*^9, 3.732897783610815*^9}, {3.732897852077343*^9, 
   3.732897862802062*^9}, {3.732897941046487*^9, 3.732897954251421*^9}, {
   3.732898130111085*^9, 3.732898137776148*^9}, {3.732898444134014*^9, 
   3.7328984568685284`*^9}, {3.7328985378626595`*^9, 3.732898547392453*^9}, {
   3.732898637313116*^9, 3.732898654578396*^9}, {3.7328987315863705`*^9, 
   3.7328987411761837`*^9}, {3.732898814480356*^9, 3.732898823540183*^9}, {
   3.732898896438599*^9, 3.7328989054537897`*^9}, {3.7329000332477894`*^9, 
   3.7329000413875446`*^9}, {3.732901393229869*^9, 3.7329014039800205`*^9}, {
   3.732901494570811*^9, 3.7329015020807467`*^9}, {3.733009580033913*^9, 
   3.733009581879031*^9}, {3.7330109877389793`*^9, 3.7330110696720524`*^9}, 
   3.7330853686256504`*^9, {3.7340233736295276`*^9, 3.734023402428831*^9}, {
   3.734023612709117*^9, 3.734023638923421*^9}, 3.7340236702391405`*^9, 
   3.734025704502059*^9, {3.734025747500244*^9, 3.7340257634393883`*^9}, {
   3.7340259269041195`*^9, 3.7340259665368423`*^9}, {3.7340307328013268`*^9, 
   3.734030749322783*^9}, {3.7340309989579735`*^9, 3.7340309998527875`*^9}, {
   3.734032546631898*^9, 3.7340325516919165`*^9}, {3.734037171921851*^9, 
   3.734037182856868*^9}, {3.734037237263196*^9, 3.7340372479982405`*^9}, {
   3.734037320696334*^9, 3.7340373290913286`*^9}, {3.7340374024057455`*^9, 
   3.7340374121858516`*^9}, {3.734037485302636*^9, 3.734037494797657*^9}, {
   3.734037560478919*^9, 3.734037569679203*^9}, {3.7340376346820335`*^9, 
   3.7340376424671*^9}, {3.7340378334162407`*^9, 3.734037841056549*^9}, {
   3.7340379146041265`*^9, 3.734037920029069*^9}, {3.7340379899110518`*^9, 
   3.7340380001260023`*^9}, {3.7340380689525337`*^9, 3.734038078842559*^9}, {
   3.7340381435638704`*^9, 3.7340381537189207`*^9}, {3.734038224082117*^9, 
   3.734038232002242*^9}, {3.734038300988067*^9, 3.734038308402877*^9}, {
   3.734038378339017*^9, 3.734038386134289*^9}, {3.734038446295672*^9, 
   3.7340384545356803`*^9}, {3.7340385162337475`*^9, 
   3.7340385256489935`*^9}, {3.7340385963554316`*^9, 
   3.7340386045655994`*^9}, {3.7340386636437707`*^9, 
   3.7340386728938828`*^9}, {3.734038744140399*^9, 3.734038753589913*^9}, {
   3.734038808448408*^9, 3.7340388167135553`*^9}, {3.7340388737866435`*^9, 
   3.7340388829966497`*^9}, {3.7340389530431204`*^9, 
   3.7340389597881975`*^9}, {3.7340390214876213`*^9, 
   3.7340390303726616`*^9}, {3.734039091589052*^9, 3.734039101789356*^9}, {
   3.7340391631870117`*^9, 3.7340391722371454`*^9}, {3.7340392384985714`*^9, 
   3.7340392461085234`*^9}, {3.7340393557203307`*^9, 
   3.7340393635204268`*^9}, {3.734039423428363*^9, 3.7340394319985104`*^9}, {
   3.734039493709517*^9, 3.7340395008998594`*^9}, {3.734039560882683*^9, 
   3.7340395698380566`*^9}, {3.734039627447457*^9, 3.7340396357174115`*^9}, {
   3.7340396945102377`*^9, 3.7340397015004005`*^9}, {3.734039831943036*^9, 
   3.734039845891075*^9}, {3.7340399380100565`*^9, 3.734039946145313*^9}, {
   3.7340401219579983`*^9, 3.7340401308182397`*^9}, {3.7340401957824774`*^9, 
   3.7340402035824547`*^9}, {3.734040274888051*^9, 3.734040283608266*^9}, {
   3.7340403360710483`*^9, 3.7340403440860734`*^9}, {3.7340404179419627`*^9, 
   3.734040426112172*^9}, {3.734040485224328*^9, 3.7340404944094977`*^9}, {
   3.7340405667155304`*^9, 3.73404057467065*^9}, {3.734040629084879*^9, 
   3.7340406380451374`*^9}, {3.734523245908614*^9, 3.734523308430374*^9}, {
   3.7345235458587437`*^9, 3.7345235763461323`*^9}, {3.734649332912223*^9, 
   3.7346493430019836`*^9}, {3.7346494320076103`*^9, 3.734649443357955*^9}, {
   3.734649623088647*^9, 3.7346496313835955`*^9}, {3.7346497137435265`*^9, 
   3.734649722178553*^9}, {3.7346497935302134`*^9, 3.7346498022202005`*^9}, {
   3.734649868719274*^9, 3.7346498761193104`*^9}, {3.7346499365563946`*^9, 
   3.734649944620283*^9}, {3.7346500113638163`*^9, 3.7346500204889126`*^9}, {
   3.7346500897327385`*^9, 3.73465009826799*^9}, {3.734650179349145*^9, 
   3.734650186894432*^9}, {3.7346502539633026`*^9, 3.734650259583354*^9}, {
   3.734650335705487*^9, 3.734650344475439*^9}, {3.734650428147414*^9, 
   3.7346504359524193`*^9}, {3.7346505013874016`*^9, 
   3.7346505130223646`*^9}, {3.734650602215355*^9, 3.734650609775277*^9}, {
   3.734650682373746*^9, 3.7346506892838635`*^9}, {3.734650755556369*^9, 
   3.7346507632263646`*^9}, {3.734650845865383*^9, 3.734650854084281*^9}, {
   3.7346509538026023`*^9, 3.734650963607527*^9}, {3.734651026237143*^9, 
   3.7346510393555984`*^9}, {3.7346511204767513`*^9, 3.734651130522726*^9}, {
   3.734651201294263*^9, 3.7346512097495995`*^9}, {3.734651290113412*^9, 
   3.7346513063745537`*^9}, {3.7346513691056223`*^9, 3.734651379696602*^9}, {
   3.7346514529861374`*^9, 3.7346514612619286`*^9}, {3.7346515359290123`*^9, 
   3.734651544749866*^9}, {3.734651615437511*^9, 3.7346516233794694`*^9}, {
   3.734651704590139*^9, 3.7346517128011827`*^9}, {3.734651776959097*^9, 
   3.7346517842450514`*^9}, {3.7346518602434225`*^9, 
   3.7346518680593967`*^9}, {3.734651925587318*^9, 3.734651932772091*^9}, {
   3.7346519901645985`*^9, 3.734651998959485*^9}, {3.734652060064142*^9, 
   3.73465206844411*^9}, {3.7346521328288665`*^9, 3.7346521441839094`*^9}, {
   3.734652202101719*^9, 3.734652209666669*^9}, {3.734652271073217*^9, 
   3.7346522775932846`*^9}, {3.7346523795531187`*^9, 3.734652387442948*^9}, {
   3.7346524645571117`*^9, 3.734652473285882*^9}, {3.734652541916098*^9, 
   3.734652550936026*^9}, {3.734652629755961*^9, 3.734652639220975*^9}, {
   3.734652701321437*^9, 3.734652709401354*^9}, {3.73465277652772*^9, 
   3.734652784097807*^9}, {3.734652853777909*^9, 3.734652866692814*^9}, {
   3.7346529407374516`*^9, 3.734652950472505*^9}, {3.7346530368351154`*^9, 
   3.734653046515175*^9}, {3.736287153920436*^9, 3.7362876389856586`*^9}, {
   3.736287669773321*^9, 3.736287737073059*^9}, {3.736287771197833*^9, 
   3.736287900179912*^9}, 3.7363269365422335`*^9, {3.7363270850655546`*^9, 
   3.736327128747137*^9}, {3.7363271694872837`*^9, 3.7363272482334194`*^9}, 
   3.73632728116494*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"4f0adf13-5c6d-4e8d-96d0-8f7b73702c56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctimagedir", "=", 
   RowBox[{"SystemDialogInput", "[", "\"\<Directory\>\"", "]"}]}], ";", 
  RowBox[{"testfiles", "=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*.dcm\>\"", ",", "ctimagedir", ",", "Infinity"}], "]"}], 
     ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7251967691767864`*^9, 3.725196773577967*^9}, {
   3.725197245251943*^9, 3.7251973206417356`*^9}, 3.728757100993621*^9, {
   3.7328875758646545`*^9, 3.732887588854679*^9}, {3.736287914402076*^9, 
   3.7362883108201995`*^9}, 3.736324595158544*^9, {3.73632463007747*^9, 
   3.7363246760434513`*^9}, {3.736327032788513*^9, 3.7363270565589895`*^9}, {
   3.7363318924388237`*^9, 3.736331958805314*^9}},
 NumberMarks->False,
 CellLabel->"In[2]:=",ExpressionUUID->"c6dfa352-86f8-4333-9d63-ac5627d77bca"],

Cell["\<\
This attempts to find DICOM files in the chosen file directory.  The code \
searches any subdirectories.  For my study I only transferred one sequence of \
axial images.  Including multiple sequences would likely cause the algorithm \
to fail.  This could be fixed by checking the DICOM header to include only \
primary axial sequences.  For a spot check it is easy to instruct the \
radiation technologist to only send the axial sequences.\
\>", "Text",
 CellChangeTimes->{{3.7251967691767864`*^9, 3.725196773577967*^9}, {
   3.725197245251943*^9, 3.7251973206417356`*^9}, 3.728757100993621*^9, {
   3.7328875758646545`*^9, 3.732887588854679*^9}, {3.736287914402076*^9, 
   3.7362883108201995`*^9}, 3.736324595158544*^9, {3.73632463007747*^9, 
   3.7363246760434513`*^9}, {3.736327032788513*^9, 3.7363270565589895`*^9}, 
   3.7363279041407175`*^9, {3.7364196907007046`*^9, 3.7364197989858*^9}, 
   3.7364198411939607`*^9, {3.7492347579788513`*^9, 3.7492347613507953`*^9}, {
   3.749293471926635*^9, 3.749293487022312*^9}},
 NumberMarks->False,ExpressionUUID->"9525740b-7b95-472f-9ea4-b6017ae37ea2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"count", "=", 
   RowBox[{"Length", "[", "testfiles", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7251967691767864`*^9, 3.725196773577967*^9}, {
   3.725197245251943*^9, 3.7251973206417356`*^9}, 3.728757100993621*^9, {
   3.7328875758646545`*^9, 3.732887588854679*^9}, {3.736287914402076*^9, 
   3.7362883108201995`*^9}, 3.736324595158544*^9, {3.73632463007747*^9, 
   3.7363246760434513`*^9}, {3.736327032788513*^9, 3.7363270425550437`*^9}},
 NumberMarks->False,
 CellLabel->"In[3]:=",ExpressionUUID->"2e93bb9f-593a-4ee8-8a9b-fa11cc87b1f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dicomheader", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"testfiles", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<MetaInformation\>\""}], 
    "]"}]}], ";", 
  RowBox[{"dicomtags", "=", 
   RowBox[{"<|", " ", "|>"}]}], ";", 
  RowBox[{"AssociateTo", "[", 
   RowBox[{"dicomtags", ",", "dicomheader"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dicomkeys", " ", "=", 
    RowBox[{"Keys", "[", "dicomtags", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Print", "[", 
        RowBox[{"#", ",", " ", "\"\<->\>\"", ",", 
         RowBox[{"dicomtags", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ")"}], " ", "&"}], " ", "/@",
      "dicomkeys"}], ";", " ", 
    RowBox[{
    "Uncomment", " ", "this", " ", "line", " ", "of", " ", "code", " ", "if", 
     " ", "you", " ", "wish", " ", "to", " ", "see", " ", "the", " ", "DICOM",
      " ", "data"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.73642177634175*^9, 3.736421954424056*^9}, {
   3.7364219879583516`*^9, 3.736421994114407*^9}, {3.7364221920315704`*^9, 
   3.736422196313286*^9}, {3.736422244735542*^9, 3.7364222473451257`*^9}, {
   3.7364222850986276`*^9, 3.7364222987256393`*^9}, {3.7364223612657504`*^9, 
   3.736422429451512*^9}, {3.7364224631425796`*^9, 3.736422525494446*^9}, {
   3.7364227142618012`*^9, 3.736422757657065*^9}, {3.7364234459572697`*^9, 
   3.736423567971636*^9}, {3.7364236025528297`*^9, 3.736423672341812*^9}, {
   3.736423705626267*^9, 3.7364237543199024`*^9}, {3.7364237869327383`*^9, 
   3.736423839560214*^9}, {3.736423895034793*^9, 3.736423940430629*^9}, {
   3.7364239940147905`*^9, 3.736424000593241*^9}, {3.7364240605683684`*^9, 
   3.736424093149938*^9}, {3.736424135671345*^9, 3.73642425860579*^9}, {
   3.736424418451855*^9, 3.7364244553151674`*^9}, {3.73642450891562*^9, 
   3.7364245810171437`*^9}, {3.7364246424453554`*^9, 
   3.7364246892639956`*^9}, {3.7364247193292427`*^9, 3.736424724298519*^9}, {
   3.7364248473133936`*^9, 3.7364248631906557`*^9}, {3.736424918540144*^9, 
   3.7364249254156127`*^9}, {3.736424964935253*^9, 3.736424998986247*^9}, {
   3.736425029146703*^9, 3.7364250637285423`*^9}, {3.7364251033577414`*^9, 
   3.736425127344761*^9}, {3.7364251864911904`*^9, 3.736425195491619*^9}, 
   3.7364252342613573`*^9, {3.7492935391206045`*^9, 3.7492936076294847`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"1a8bc33f-a917-4e29-a661-6cd06ddebd3c"],

Cell["\<\
(The DICOM header does not have to be displayed for every image. However, it \
is best to examine the DICOM header when applying this program to CT images \
from a previously untested CT machine. The program may need to be modified \
based on information included in the DICOM header.  The calculation of SSDE \
in this algorithm is based on:
a) the \[OpenCurlyDoubleQuote]ImageType\[CloseCurlyDoubleQuote] (which should \
be \[OpenCurlyDoubleQuote]\[OpenCurlyDoubleQuote]ORIGINAL\
\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]PRIMARY\
\[CloseCurlyDoubleQuote],\[CloseCurlyDoubleQuote]AXIAL\[CloseCurlyDoubleQuote]\
\[CloseCurlyDoubleQuote]), 
b) the pixel spacing (for the area of the pixel), 
c) the rescale slope and intercept (needed to convert data back to Hounsfield \
units)
d) the stored bits {to convert the stored interger data to the fractional \
pixel value used in the Mathematica algorithms).

The DICOM header can be displayed for the first NIH image.  In the DICOM \
header for this NIH case, the rescale slope is 1.  The rescale intercept is \
-1024. The bits stored is 12. The image type is primary axial.  These \
indicate that the tissue values should work, and that the images are axial. \
There is no slice CTDI vol, so I would read the reported CTDIvol from the \
dose summary page.  There is no dose page available, so I will use a \
demonstration value (15mGy) for the CTDIvol. If the rescale slope and \
intercept are unavailable, then calculation by pixel attenuation may be \
unreliable.  If the rescale slope and intercept are not provided, then the \
simple pixel area calculation (CAMPS) is preferred.  

I had downloaded the full image set on the case described.  From that image \
set, I put 6 images in a subfolder for demonstration purposes.  The time to \
process the reduced set (displaying only the SSDE) is approximately 1 second \
per image on my laptop.  If I display the images, the time increases to about \
1 minute per image.  The increase in time when displaying images begins to \
increase exponentially, depending on your hardware configuration.\
\>", "Text",
 CellChangeTimes->{{3.7363320979655237`*^9, 3.7363322054117827`*^9}, {
  3.7363322710264506`*^9, 3.7363323545947914`*^9}, {3.7363324677309093`*^9, 
  3.736332570599359*^9}, {3.73641988777159*^9, 3.736420149470783*^9}, {
  3.736420280828556*^9, 3.7364202858913665`*^9}, {3.7364203187713127`*^9, 
  3.736420709892398*^9}, {3.7492363689273157`*^9, 3.7492365875321884`*^9}, {
  3.749293647357387*^9, 3.749293689476839*^9}, {3.7493001047487545`*^9, 
  3.7493003472505865`*^9}},ExpressionUUID->"94912574-9662-494d-9edc-\
210b249fac10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ctdivol", "=", "15"}], ";", 
  RowBox[{"uppertissuevalue", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1024", "+", "150"}], ")"}], "/", "4096"}], "]"}]}], ";", 
  RowBox[{"lowertissuevalue", " ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1024", "-", "300"}], ")"}], "/", "4096"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7213157939525623`*^9, 3.7213160517251973`*^9}, {
   3.72131659417714*^9, 3.7213170214663982`*^9}, {3.7213173898646574`*^9, 
   3.7213173990353327`*^9}, {3.721317439540661*^9, 3.721317641297191*^9}, {
   3.7213176768394794`*^9, 3.72131778528903*^9}, {3.721317840838352*^9, 
   3.721317868532396*^9}, {3.7213179260119686`*^9, 3.7213179292278643`*^9}, {
   3.7213180908463836`*^9, 3.721318106940545*^9}, 3.721318158448204*^9, {
   3.7213181939843807`*^9, 3.7213182131176186`*^9}, {3.7213182574429364`*^9, 
   3.7213188523252354`*^9}, {3.7213189058479824`*^9, 
   3.7213189095275345`*^9}, {3.7213189448121233`*^9, 3.721318970683914*^9}, {
   3.7213191453231544`*^9, 3.721319263913287*^9}, {3.721319392649277*^9, 
   3.7213194046680484`*^9}, {3.7213195127317944`*^9, 3.7213196574186*^9}, {
   3.721320135690117*^9, 3.7213201522148523`*^9}, {3.7213201917419386`*^9, 
   3.7213201979920855`*^9}, {3.721320245586672*^9, 3.7213202524020166`*^9}, {
   3.72132031040001*^9, 3.7213203117873535`*^9}, {3.7213204000737267`*^9, 
   3.7213204009966145`*^9}, {3.72132044307236*^9, 3.7213204439083886`*^9}, {
   3.7213205190882854`*^9, 3.7213205247593775`*^9}, {3.7213205740800896`*^9, 
   3.721320575263229*^9}, {3.7213206998160706`*^9, 3.721320703047414*^9}, {
   3.721321111758009*^9, 3.721321113602031*^9}, {3.72132119529132*^9, 
   3.721321198628171*^9}, {3.721321259066043*^9, 3.721321262644511*^9}, {
   3.72132138111357*^9, 3.7213213817397423`*^9}, {3.7213216390928507`*^9, 
   3.7213216409995975`*^9}, {3.7213217003944187`*^9, 
   3.7213217019942527`*^9}, {3.721321765153899*^9, 3.721321767556595*^9}, {
   3.721322115826355*^9, 3.7213221221211743`*^9}, 3.7213223520820656`*^9, {
   3.721322399587906*^9, 3.721322425413041*^9}, {3.721322555893797*^9, 
   3.7213225813842125`*^9}, {3.721323002855817*^9, 3.7213231034328375`*^9}, {
   3.7213236399359517`*^9, 3.721323641489779*^9}, {3.729961080100047*^9, 
   3.729961125578484*^9}, {3.729961161956279*^9, 3.7299613647987556`*^9}, {
   3.7327997745318413`*^9, 3.7327999326692996`*^9}, {3.7328059727577486`*^9, 
   3.732805982043279*^9}, {3.732806058183943*^9, 3.732806085270729*^9}, {
   3.7328829399970064`*^9, 3.7328829590635624`*^9}, {3.7330096242549276`*^9, 
   3.7330100209736357`*^9}, {3.7330101045837827`*^9, 3.733010231271041*^9}, {
   3.7330111243209105`*^9, 3.7330114852498455`*^9}, 3.7340237041524544`*^9, {
   3.734025181407214*^9, 3.734025187537466*^9}, {3.736288329269252*^9, 
   3.736288855347*^9}, {3.736324712169779*^9, 3.736324895881446*^9}, {
   3.7363260543682117`*^9, 3.7363261209144516`*^9}, {3.7363261509631057`*^9, 
   3.7363261722436857`*^9}, {3.7363325778345413`*^9, 3.7363325853975945`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f7a85031-721d-4814-8508-c528ab312cad"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "following", " ", "code", " ", "will", " ", "display", " ", 
     "the", " ", "result", " ", "of", " ", "morphologic", " ", 
     RowBox[{"processing", ".", "  ", "Uncomment"}], " ", "this", " ", "if", 
     " ", "you", " ", "wish", " ", "to", " ", "see", " ", "the", " ", 
     "identified", " ", "body", " ", 
     RowBox[{"pixels", ".", "  ", "This"}], " ", "is", " ", "very", " ", 
     "slow", " ", "because", " ", "of", " ", "all", " ", "the", " ", "images",
      " ", "it", " ", 
     RowBox[{"stores", ".", "  ", "It"}], " ", "will", " ", "easily", " ", 
     "overun", " ", "the", " ", "memory", " ", "allocation", " ", "if", " ", 
     "there", " ", "are", " ", "too", " ", "many", " ", 
     RowBox[{"images", ".", "  ", "A"}], " ", "reasonable", " ", "number", 
     " ", "of", " ", "images", " ", "for", " ", "this", " ", "code", " ", 
     "to", " ", "work", " ", "would", " ", "be", " ", "5", " ", 
     RowBox[{"images", ".", "  ", "Running"}], " ", "this", " ", "code", " ", 
     "is", " ", "unnecessary", " ", "to", " ", "calculate", " ", "SSDE", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "stdimage"}], "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"morbinimage", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"masks", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dcmfile", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dicomheader", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"dcmfile", ",", "\"\<MetaInformation\>\""}], "]"}]}], ";", 
        RowBox[{"dicomtags", "=", 
         RowBox[{"<|", " ", "|>"}]}], ";", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"dicomtags", ",", "dicomheader"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dicomkeys", "=", 
         RowBox[{"Keys", "[", "dicomtags", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"dicomkeys", ",", "\"\<PixelSpacing\>\""}], "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pixelspacingx", ",", "pixelspacingy"}], "}"}], "=", 
           RowBox[{
           "dicomtags", "\[LeftDoubleBracket]", "\"\<PixelSpacing\>\"", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pixelspacingx", ",", "pixelspacingy"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{".97", ",", ".97"}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"dicomkeys", ",", "\"\<(0018,9345)\>\""}], "]"}], ",", 
          RowBox[{"slicectdivol", " ", "=", " ", 
           RowBox[{
           "dicomtags", "\[LeftDoubleBracket]", "\"\<(0018,9345)\>\"", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"slicectdivol", " ", "=", " ", "ctdivol"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "dicomtags", "\[LeftDoubleBracket]", "\"\<(0018,9345)\>\"", 
           "\[RightDoubleBracket]"}], ";", " ", 
          RowBox[{
          "DICOM", " ", "tag", " ", "for", " ", "slice", " ", "CTDIvol"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"imagetypes", "=", 
         RowBox[{"dicomtags", "[", 
          RowBox[{"[", "\"\<ImageType\>\"", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AnyTrue", "[", 
            RowBox[{"imagetypes", ",", 
             RowBox[{
              RowBox[{"StringMatchQ", "[", 
               RowBox[{"#", ",", "\"\<AXIAL\>\""}], "]"}], "&"}]}], "]"}]}], 
          ",", "Return"}], "]"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Skip", " ", "non", " ", "axial", " ", "images"}], "..."}],
           " ", "not", " ", "yet", " ", "tested", " ", "flow", " ", 
          RowBox[{"control", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"im", "=", 
         RowBox[{"Import", "[", "dcmfile", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imb", "=", 
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"MorphologicalBinarize", "[", 
           RowBox[{"im", ",", " ", 
            RowBox[{"{", 
             RowBox[{"lowertissuevalue", ",", "uppertissuevalue"}], "}"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"stdimage", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"stdimage", ",", 
           RowBox[{"ImageAdjust", "[", "im", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"morbinimage", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"morbinimage", ",", "imb"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imd", "=", 
         RowBox[{"Image", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"dcmfile", ",", "\"\<Data\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imf", "=", 
         RowBox[{"FillingTransform", "[", "imb", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"masks", ",", "imf"}], "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}], "&"}], " ", "/@", "testfiles"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ImageCollage", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"stdimage", ",", "morbinimage", ",", "masks"}], "}"}], "]"}],
        "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.729944648674604*^9, 3.7299447217628813`*^9}, {
   3.729945031064421*^9, 3.729945053074486*^9}, {3.729945255884924*^9, 
   3.7299453161386833`*^9}, {3.72994562850379*^9, 3.7299456518782396`*^9}, {
   3.732831814062115*^9, 3.7328318523596616`*^9}, {3.732831992167549*^9, 
   3.7328320407280335`*^9}, {3.7328320816927214`*^9, 3.732832178025756*^9}, {
   3.732882028349414*^9, 3.732882034689023*^9}, {3.7328830559208755`*^9, 
   3.7328830922525225`*^9}, {3.732883153801676*^9, 3.732883190504909*^9}, {
   3.7328832518668633`*^9, 3.7328833443280535`*^9}, {3.7328834700275016`*^9, 
   3.7328835455346594`*^9}, {3.7328835876453485`*^9, 3.732883710733283*^9}, {
   3.732883742652387*^9, 3.7328838222912054`*^9}, {3.7328839570539584`*^9, 
   3.7328839822041316`*^9}, {3.732884156512292*^9, 3.7328842186989098`*^9}, {
   3.7328842487186584`*^9, 3.732884468701375*^9}, {3.732884595708651*^9, 
   3.7328846573963656`*^9}, {3.732887337532399*^9, 3.7328873434224577`*^9}, {
   3.7328880335567656`*^9, 3.7328880359966593`*^9}, {3.732888093528102*^9, 
   3.7328881016785097`*^9}, {3.7330102357310495`*^9, 
   3.7330102709349775`*^9}, {3.733010390057325*^9, 3.7330104275962315`*^9}, {
   3.7330104666653843`*^9, 3.7330105245483484`*^9}, {3.7330105639982023`*^9, 
   3.733010609578208*^9}, {3.7330106431675725`*^9, 3.7330108202484612`*^9}, {
   3.7330108529221115`*^9, 3.7330109211095915`*^9}, {3.7330115095149665`*^9, 
   3.7330115104199376`*^9}, {3.7330116042280903`*^9, 
   3.7330116348423457`*^9}, {3.7330117370166254`*^9, 3.733011779180728*^9}, {
   3.7330122236620617`*^9, 3.7330124089906206`*^9}, {3.7330126192299995`*^9, 
   3.7330126275601835`*^9}, {3.7330650598516016`*^9, 3.733065061576557*^9}, {
   3.73306512025354*^9, 3.7330651365049787`*^9}, {3.733065269064102*^9, 
   3.7330653381288414`*^9}, {3.7330653699095097`*^9, 3.733065372194555*^9}, {
   3.7330655532591896`*^9, 3.7330655601044197`*^9}, {3.7330656276418257`*^9, 
   3.733065633546733*^9}, {3.733065671982086*^9, 3.733065681646696*^9}, {
   3.733065715597711*^9, 3.7330657661233845`*^9}, {3.7330852726586914`*^9, 
   3.73308529653894*^9}, {3.733085402727043*^9, 3.733085412072318*^9}, {
   3.7331032562600603`*^9, 3.7331032866673307`*^9}, {3.7340234392484784`*^9, 
   3.7340234430984373`*^9}, 3.734023753307974*^9, {3.7340237868328023`*^9, 
   3.7340240095107093`*^9}, {3.734024048350379*^9, 3.734024168595209*^9}, {
   3.7340242011696978`*^9, 3.7340242554966936`*^9}, {3.7340242874716434`*^9, 
   3.734024369825183*^9}, {3.734024423284918*^9, 3.734024452069275*^9}, {
   3.73402450529538*^9, 3.734024747642197*^9}, {3.7340248199305415`*^9, 
   3.7340248331315837`*^9}, {3.7340249859099483`*^9, 
   3.7340249915551825`*^9}, {3.734025050338909*^9, 3.7340251569714394`*^9}, {
   3.734025294722721*^9, 3.7340255454703217`*^9}, {3.7340256012503633`*^9, 
   3.7340256032505817`*^9}, {3.734025633894921*^9, 3.7340256384906116`*^9}, 
   3.734025835974298*^9, {3.7340260393782253`*^9, 3.7340261901803536`*^9}, {
   3.7340305689747543`*^9, 3.7340305811095805`*^9}, {3.7340308443535833`*^9, 
   3.734030878124737*^9}, {3.734031323272357*^9, 3.734031331452464*^9}, {
   3.7340324756513586`*^9, 3.7340325209809675`*^9}, {3.7340326105690837`*^9, 
   3.734032617674038*^9}, {3.734032683724497*^9, 3.7340326953644147`*^9}, {
   3.7340357518910046`*^9, 3.734035780666342*^9}, {3.7340362218928127`*^9, 
   3.7340362280684023`*^9}, 3.734036276018947*^9, {3.7340365356999097`*^9, 
   3.734036700633228*^9}, {3.7340367497598963`*^9, 3.734036781603118*^9}, {
   3.734036823158493*^9, 3.734036855504981*^9}, {3.7344355763086405`*^9, 
   3.7344356184978523`*^9}, {3.734435673233058*^9, 3.7344358251312776`*^9}, {
   3.734523350160618*^9, 3.7345233592079067`*^9}, {3.7345234088192387`*^9, 
   3.73452345146503*^9}, 3.7345236047423954`*^9, {3.734523754120576*^9, 
   3.7345238350686207`*^9}, {3.7345238791342683`*^9, 3.734523886305972*^9}, {
   3.734523953416603*^9, 3.7345239665895357`*^9}, {3.734645926677087*^9, 
   3.7346459800032964`*^9}, {3.7346489084388485`*^9, 
   3.7346490472711744`*^9}, {3.7346490853007364`*^9, 
   3.7346491311346235`*^9}, {3.7346491735945587`*^9, 3.734649214463893*^9}, {
   3.7346493078018527`*^9, 3.7346493127519846`*^9}, {3.7346494976500983`*^9, 
   3.7346495094800167`*^9}, 3.734649553076559*^9, {3.736300976799426*^9, 
   3.736301348143498*^9}, {3.7363014156222115`*^9, 3.736301438489749*^9}, {
   3.7363014725394998`*^9, 3.7363015367986193`*^9}, 3.7363279210488524`*^9, {
   3.7363282228905277`*^9, 3.7363284675844975`*^9}, {3.7363285211969323`*^9, 
   3.7363287347640905`*^9}, {3.7363288829404507`*^9, 
   3.7363289172434883`*^9}, {3.7363292931407194`*^9, 3.736329293859557*^9}, 
   3.736331992541136*^9, {3.7363326121504316`*^9, 3.7363328525461907`*^9}, {
   3.7363354460089636`*^9, 3.736335475215211*^9}, {3.7363356292618985`*^9, 
   3.736335645364339*^9}, {3.736335740745422*^9, 3.736335784406092*^9}, {
   3.7363359247725058`*^9, 3.7363359319607697`*^9}, {3.736336029003379*^9, 
   3.7363360355041103`*^9}, {3.736420816721382*^9, 3.736420861118563*^9}, {
   3.7364213970649815`*^9, 3.736421419129826*^9}, {3.736421463790255*^9, 
   3.7364215375173845`*^9}, {3.736421605603548*^9, 3.7364216108077126`*^9}, {
   3.7364227989270363`*^9, 3.736422904825961*^9}, {3.7364229492521067`*^9, 
   3.7364230738761687`*^9}, {3.736425254529133*^9, 3.736425294158889*^9}, {
   3.7364253613373413`*^9, 3.7364253791181297`*^9}, {3.736425426779378*^9, 
   3.736425474175287*^9}, {3.736425659633929*^9, 3.736425766644654*^9}, {
   3.73642580196092*^9, 3.7364258371988573`*^9}, {3.7364258771092815`*^9, 
   3.736425891470418*^9}, {3.737206058114013*^9, 3.737206078599052*^9}, {
   3.7492937414491425`*^9, 3.7492939360951004`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"6050b0d4-940b-4d04-8fd5-ce0d10847807"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "following", " ", "will", " ", "execute", " ", "much", " ", 
     "faster", " ", "because", " ", "it", " ", "does", " ", "not", " ", 
     "print", " ", "the", " ", "DICOM", " ", "header"}], ",", 
    RowBox[{"or", " ", "display", " ", 
     RowBox[{"images", ".", " ", "It"}], " ", "prints", " ", "only", " ", 
     "the", " ", "SSDE"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dcmfile", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dicomheader", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"dcmfile", ",", "\"\<MetaInformation\>\""}], "]"}]}], ";", 
      RowBox[{"dicomtags", "=", 
       RowBox[{"<|", " ", "|>"}]}], ";", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"dicomtags", ",", "dicomheader"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dicomkeys", "=", 
       RowBox[{"Keys", "[", "dicomtags", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"dicomkeys", ",", "\"\<PixelSpacing\>\""}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pixelspacingx", ",", "pixelspacingy"}], "}"}], "=", 
         RowBox[{
         "dicomtags", "\[LeftDoubleBracket]", "\"\<PixelSpacing\>\"", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pixelspacingx", ",", "pixelspacingy"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{".97", ",", ".97"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"dicomkeys", ",", "\"\<(0018,9345)\>\""}], "]"}], ",", 
        RowBox[{"slicectdivol", " ", "=", " ", 
         RowBox[{
         "dicomtags", "\[LeftDoubleBracket]", "\"\<(0018,9345)\>\"", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"slicectdivol", " ", "=", " ", "ctdivol"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "dicomtags", "\[LeftDoubleBracket]", "\"\<(0018,9345)\>\"", 
         "\[RightDoubleBracket]"}], ";", " ", 
        RowBox[{
        "DICOM", " ", "tag", " ", "for", " ", "slice", " ", "CTDIvol"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"imagetypes", "=", 
       RowBox[{"dicomtags", "[", 
        RowBox[{"[", "\"\<ImageType\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{"imagetypes", ",", 
           RowBox[{
            RowBox[{"StringMatchQ", "[", 
             RowBox[{"#", ",", "\"\<AXIAL\>\""}], "]"}], "&"}]}], "]"}]}], 
        ",", "Return"}], "]"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Skip", " ", "non", " ", "axial", " ", "images"}], "..."}], 
        " ", "not", " ", "yet", " ", "tested", " ", "flow", " ", 
        RowBox[{"control", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"im", "=", 
       RowBox[{"Import", "[", "dcmfile", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imb", "=", 
       RowBox[{"DeleteSmallComponents", "[", 
        RowBox[{"MorphologicalBinarize", "[", 
         RowBox[{"im", ",", " ", 
          RowBox[{"{", 
           RowBox[{"lowertissuevalue", ",", "uppertissuevalue"}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "The", " ", "simple", " ", "CAMPS", " ", "algorithm", " ", 
          "determines", " ", "estimated", " ", "phantom", " ", "diameter", 
          " ", "with", " ", "the", " ", "single", " ", "code", " ", "line", 
          " ", 
          RowBox[{"of", ":", " ", "\[IndentingNewLine]", "edw"}]}], "=", " ", 
         RowBox[{"2", "*", "pixelspacingx", " ", "*", ".1", "*", 
          RowBox[{
           RowBox[{"Values", "[", 
            RowBox[{"ComponentMeasurements", "[", 
             RowBox[{"imb", ",", "\"\<EquivalentDiskRadius\>\""}], "]"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"imd", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"dcmfile", ",", "\"\<Data\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imf", "=", 
       RowBox[{"FillingTransform", "[", "imb", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"npixels", "=", 
       RowBox[{
        RowBox[{"Values", "[", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"imf", ",", "\"\<Count\>\""}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"adjpixs", "=", 
       RowBox[{
        RowBox[{"PixelValue", "[", 
         RowBox[{"imd", ",", "imf"}], "]"}], "-", "1024"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totpixs", "=", 
       RowBox[{"Total", "[", "adjpixs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pixelarea", "=", 
       RowBox[{"pixelspacingx", "*", "pixelspacingy"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"roiarea", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pixelarea", "*", "npixels"}], ")"}], "/", "100"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eDw", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Mean", "[", "adjpixs", "]"}], "/", "1000"}], ")"}], 
             "+", "1"}], ")"}], "*", 
           RowBox[{"roiarea", "/", "Pi"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"slice32adjfactorDw", "=", 
       RowBox[{"convfactor32", "[", "eDw", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"slicessdeDw", " ", "=", " ", 
       RowBox[{"slice32adjfactorDw", "*", "slicectdivol"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "slicessdeDw", "]"}]}], "\[IndentingNewLine]", 
     ")"}], "&"}], " ", "/@", "testfiles"}]}]], "Input",
 CellChangeTimes->{{3.7372055397441134`*^9, 3.7372055687473125`*^9}, {
  3.7372056087679996`*^9, 3.737205631348482*^9}, {3.7492273315845575`*^9, 
  3.7492273667289205`*^9}, {3.7492348679683065`*^9, 3.7492348997752914`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"1dc8e6fc-64fa-4cc0-932b-e87b576d6cc3"],

Cell[CellGroupData[{

Cell[BoxData["18.36899604022856`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.7517557788761797`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"509cc946-a726-4df5-9534-fd00a51f90f0"],

Cell[BoxData["20.51291646992113`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.7517557792801*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"b67be096-9a21-4b10-b436-1d2870256e6a"],

Cell[BoxData["20.22538646558337`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.751755779699979*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"fcf85a1a-e766-42cc-9b7c-ce808ad01fca"],

Cell[BoxData["27.302918972014368`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.75175578012185*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"43bc327a-c324-4d2a-9f3d-6671f3b2fb79"],

Cell[BoxData["22.718220693380225`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.7517557807202525`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"8a37a8cf-81b4-4e01-9ed0-132fe42719f9"],

Cell[BoxData["26.213196589422484`"], "Print",
 CellChangeTimes->{
  3.7372063347365336`*^9, 3.737207150985598*^9, 3.7488771884976463`*^9, 
   3.7492349681794777`*^9, 3.7492351572019763`*^9, 3.7492939852106476`*^9, 
   3.749299014427355*^9, {3.749300010827302*^9, 3.749300030553177*^9}, {
   3.749300390014569*^9, 3.7493004071567497`*^9}, 3.75175578117404*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"3fe324d2-cf56-4f9b-b773-9524b9246717"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.737206336721119*^9, 3.737207152610779*^9, 3.7488771907798033`*^9, 
   3.7492350324819517`*^9, 3.749235158856556*^9, 3.7492939874576855`*^9, 
   3.7492990163213167`*^9, {3.749300013439165*^9, 3.7493000325299053`*^9}, {
   3.7493003919264936`*^9, 3.74930040910756*^9}, 3.751755781176034*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"d2df7a89-a366-4531-b8ae-b83ad053e3db"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.7493130204201493`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"6051c684-8ac6-41b8-83c9-946f7187fe4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Discussion",
 FontSize->36,
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.7492274432680464`*^9, 
  3.749227467739662*^9}},ExpressionUUID->"fd088676-8249-4f3c-841d-\
9370f821e8a3"],

Cell[TextData[StyleBox["The program code can be executed without copy and \
pasting into a separate text file.  The only requirement is to have the \
interpreter (Mathematica) available, and to have DICOM CT images in a folder. \
 This algorithm can be translated into Python, C++, MATLAB etc... with the \
appropriate libraries containing similar functions.  Because the algorithms \
having been described many years ago in standard textbooks of digital image \
processing (such as Gonzalez), they are widely available.  The algorithm \
described here has been studied and shown to produce acceptable results in \
comparison to methods employing manual measurements.  If you choose to \
develop your own algorithm, then I would recommend a similar process for \
verification.\n\nThe process for verification would include calibration of \
measurement using a standard CT phantom, and comparison to manual \
measurement.  For the standard CT phantom, just make sure there is no air in \
the phantom.  For manual measurement, I have the following recommendations:\n\
1) Measurements should be orthogonal.  I just measured the maximum AP and \
lateral dimensions, even if the patient was rotated slightly.\n2) The maximum \
AP measurement if often lateral to the midline of the body.  This is because \
of concave contours often related to the umbilicus, or the muscles in the \
back.\n3) Measurements should be made with a wide window.  I used a bone \
window.  There is a tendency to use abdomen window settings for measurements \
of body diameters.  The difference is small, but will be visible in the data \
analysis.  Either edge detection algorithms, or thresholding based algorithms \
will identify an edge slightly outside the edges typically measured with \
abdomen window settings (window width 300).\n\nIf the core statements of this \
algorithm are not modified (parameters for MorphologicalBinarize, subsequent \
DeleteSmallComponents, and FillingTransform), then the results of the study I \
performed should be applicable to the application.  I would caution that the \
SSDE premises of dosimeter measurement in a CT phantom used for establishing \
the correction factor means that the SSDE calculation should not be applied \
to the head, or to the body when arms are down to the side.  Eventually, a \
conversion factor for the head may become available, but it would have to \
include what level of the head is scanned, a measurement reflecting the \
radiodensity of the skull, and a value reflecting exposure of intracranial \
structures, as well as a value reflecting exposure of the eye.\n\nUltimately, \
calculation of radiation exposure for an individual patient should be based \
on Monte Carlo ray tracing simulations.  The SSDE is intended to facilitate \
optimization of radiation dose versus image noise.  It is very useful for \
monitoring institutional efforts for radiation dose reduction. ",
 FontSize->14]], "Text",
 CellChangeTimes->{{3.749227496975806*^9, 3.7492275015117226`*^9}, {
  3.7492291963611116`*^9, 3.749230574224289*^9}, {3.749235375814047*^9, 
  3.7492353866300926`*^9}, {3.7492354262312984`*^9, 3.7492354978476725`*^9}, {
  3.749235884563236*^9, 3.749235911839311*^9}, {3.74929400279909*^9, 
  3.7492940033496184`*^9}},ExpressionUUID->"41c18c23-bf17-4d26-85b3-\
7d12c9803326"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summary", "Chapter",
 CellChangeTimes->{{3.737201778606822*^9, 
  3.7372017996871667`*^9}},ExpressionUUID->"61850c6a-5383-4750-8fde-\
7c5dfc4c6f0c"],

Cell["\<\
This program demonstrates the use of morphologic image processing algorithms \
for application to Size Specific Dose Estimates from CT exposure.  The \
program is a straightforward and computationally efficient method of \
determining patient size from axial CT scans.  With that information, the \
SSDE may be calculated.  The program is useful for demonstrating to health \
care facilities how the SSDE is useful for optimizing the tradeoff of \
radiation exposure versus diagnostic image quality.  \
\>", "Text",
 CellChangeTimes->{{3.737201809910159*^9, 3.7372019496566095`*^9}, {
  3.737207198959831*^9, 3.7372074171528397`*^9}, {3.749235514784376*^9, 
  3.7492357444634733`*^9}, {3.7492366201666117`*^9, 
  3.7492366203471537`*^9}},ExpressionUUID->"c6a28bc3-2c56-45a8-8c49-\
b877424ade2a"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["References",
 FontColor->GrayLevel[0]]], "Section",
 CellChangeTimes->{{3.7492940894757013`*^9, 
  3.749294093391204*^9}},ExpressionUUID->"fe3fe6d1-95b7-4f62-bc05-\
911612e0b3f5"],

Cell["\<\
1.Gonzales R, Woods RE. Digital Image Processing 1977, original First Edition \
1992 edition. Latest edition 2018 Pearson Publishing Chap 9, Morphological \
Image Processing 
Note: Later editions include MATLAB coded algorithms
2. Wolfram Research, Inc., Mathematica, Version 11.3, Champaign, IL (2018). 
3. American Association of Physicists in Medicine. The Report of AAPM Task \
Group 204.  Size-specific dose estimates (SSDE) in pediatric and adult body \
CT Examinations. College Park, Md: American Association of Physicists in \
Medicine, 2011.  
4. American Association of Physicists in Medicine. The Report of AAPM Task \
Group 220. Use of Water Equivalent Diameter for Calculating Patient Size and \
Size Specific Dose Estimates (SSDE) in CT, 2014 
5. Anam C, Haryanto F, Widita R, Arif I, Dougherty G. J Appl Clin Med Phys. \
2016 Jul 8;17(4):320-333.  Automated Calculation of Water\[Hyphen]equivalent \
Diameter (DW) Based on AAPM Task Group 220 
6. Caresio JF, Bramble JM, Murphey MD. Invest Radiol. 1990 Jul;25(7):811-2. \
Perimeter encoding for teleradiology.
7. https://imaging.nci.nih.gov/ncia/login.jsf

\
\>", "Text",
 CellChangeTimes->{{3.749294372540761*^9, 3.7492944200647473`*^9}, {
   3.7492945579413695`*^9, 3.749294564262478*^9}, {3.7492946096524816`*^9, 
   3.7492946195549436`*^9}, {3.7492946501497545`*^9, 3.749294664550251*^9}, {
   3.7492946978232737`*^9, 3.749294747515452*^9}, 3.7492953238057504`*^9, {
   3.749295380799281*^9, 3.7492954325768614`*^9}, {3.7492954774911137`*^9, 
   3.749295482295252*^9}, {3.749296087550476*^9, 3.7492960897995005`*^9}, {
   3.7492963205583487`*^9, 3.74929635609003*^9}, {3.7492974715500593`*^9, 
   3.749297475543373*^9}, {3.749297533650176*^9, 3.7492975607088394`*^9}, 
   3.749298711670521*^9, {3.7492994555783195`*^9, 
   3.7492994629765496`*^9}},ExpressionUUID->"b96bd274-aa3a-4bcc-b765-\
896075dea0fc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{853, 783},
WindowMargins->{{206, Automatic}, {-46, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 5, 156, "Title",ExpressionUUID->"cf63d530-fc98-49be-8103-1cc4f150977e"],
Cell[CellGroupData[{
Cell[860, 31, 203, 4, 53, "Subsection",ExpressionUUID->"3156649a-93a1-4a97-a818-57deef095930"],
Cell[1066, 37, 15334, 210, 276, "Text",ExpressionUUID->"2a974f0f-84b1-49ce-827f-ae6405b9ba9f"],
Cell[16403, 249, 14492, 201, 72, "Text",ExpressionUUID->"1324907e-7f82-47dc-b949-61d2372fe43f"],
Cell[30898, 452, 19601, 287, 2124, "Text",ExpressionUUID->"f7551c07-98b6-4908-aca9-38ec6a581602"],
Cell[50502, 741, 12655, 179, 28, "Input",ExpressionUUID->"4f0adf13-5c6d-4e8d-96d0-8f7b73702c56"],
Cell[63160, 922, 958, 21, 48, "Input",ExpressionUUID->"c6dfa352-86f8-4333-9d63-ac5627d77bca"],
Cell[64121, 945, 1109, 16, 100, "Text",ExpressionUUID->"9525740b-7b95-472f-9ea4-b6017ae37ea2"],
Cell[65233, 963, 579, 10, 28, "Input",ExpressionUUID->"2e93bb9f-593a-4ee8-8a9b-fa11cc87b1f7"],
Cell[65815, 975, 2589, 52, 143, "Input",ExpressionUUID->"1a8bc33f-a917-4e29-a661-6cd06ddebd3c"],
Cell[68407, 1029, 2651, 42, 430, "Text",ExpressionUUID->"94912574-9662-494d-9edc-210b249fac10"],
Cell[71061, 1073, 3180, 50, 67, "Input",ExpressionUUID->"f7a85031-721d-4814-8508-c528ab312cad"],
Cell[74244, 1125, 11851, 216, 637, "Input",ExpressionUUID->"6050b0d4-940b-4d04-8fd5-ce0d10847807"],
Cell[CellGroupData[{
Cell[86120, 1345, 6736, 159, 618, "Input",ExpressionUUID->"1dc8e6fc-64fa-4cc0-932b-e87b576d6cc3"],
Cell[CellGroupData[{
Cell[92881, 1508, 465, 8, 22, "Print",ExpressionUUID->"509cc946-a726-4df5-9534-fd00a51f90f0"],
Cell[93349, 1518, 461, 8, 22, "Print",ExpressionUUID->"b67be096-9a21-4b10-b436-1d2870256e6a"],
Cell[93813, 1528, 463, 8, 22, "Print",ExpressionUUID->"fcf85a1a-e766-42cc-9b7c-ce808ad01fca"],
Cell[94279, 1538, 463, 8, 22, "Print",ExpressionUUID->"43bc327a-c324-4d2a-9f3d-6671f3b2fb79"],
Cell[94745, 1548, 466, 8, 22, "Print",ExpressionUUID->"8a37a8cf-81b4-4e01-9ed0-132fe42719f9"],
Cell[95214, 1558, 463, 8, 22, "Print",ExpressionUUID->"3fe324d2-cf56-4f9b-b773-9524b9246717"]
}, Open  ]],
Cell[95692, 1569, 529, 10, 32, "Output",ExpressionUUID->"d2df7a89-a366-4531-b8ae-b83ad053e3db"]
}, Open  ]],
Cell[96236, 1582, 167, 2, 48, "Input",ExpressionUUID->"6051c684-8ac6-41b8-83c9-946f7187fe4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96440, 1589, 218, 5, 76, "Section",ExpressionUUID->"fd088676-8249-4f3c-841d-9370f821e8a3"],
Cell[96661, 1596, 3322, 44, 663, "Text",ExpressionUUID->"41c18c23-bf17-4d26-85b3-7d12c9803326"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100020, 1645, 154, 3, 67, "Chapter",ExpressionUUID->"61850c6a-5383-4750-8fde-7c5dfc4c6f0c"],
Cell[100177, 1650, 805, 13, 122, "Text",ExpressionUUID->"c6a28bc3-2c56-45a8-8c49-b877424ade2a"],
Cell[CellGroupData[{
Cell[101007, 1667, 203, 4, 67, "Section",ExpressionUUID->"fe3fe6d1-95b7-4f62-bc05-911612e0b3f5"],
Cell[101213, 1673, 1884, 32, 342, "Text",ExpressionUUID->"b96bd274-aa3a-4bcc-b765-896075dea0fc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

